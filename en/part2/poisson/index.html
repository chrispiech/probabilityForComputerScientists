
<!DOCTYPE html>
<html>

<head>
    

<title>Poisson Distribution</title>

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta http-equiv="content-type" content="text/html; charset=UTF8">

<link rel="shortcut icon" type="image/x-icon" href="../../../favicon.ico">

<!-- Python highlighting -->
<script src="../../../plugins/prism/prism.js"></script>
<link href="../../../plugins/prism/prism.css" rel="stylesheet" />

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" integrity="sha512-uto9mlQzrs59VwILcLiRYeLKPPbS/bT71da/OEBYEwcdNUk8jYIy+D176RYoop1Da+f9mvkYrmj5MCLZWEtQuA==" crossorigin="anonymous"></script>
 <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.css" rel="Stylesheet" type="text/css" />

<!-- D3 CDN -->
<script src="https://d3js.org/d3.v3.js"></script>
<!-- <script src="https://d3js.org/d3.v4.js"></script> -->
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

<!-- Chart CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.6.0/dist/chart.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/1.0.2/chartjs-plugin-annotation.min.js" integrity="sha512-FuXN8O36qmtA+vRJyRoAxPcThh/1KJJp7WSRnjCpqA+13HYGrSWiyzrCHalCWi42L5qH1jt88lX5wy5JyFxhfQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<!-- PDF JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.min.js" integrity="sha512-Z8CqofpIcnJN80feS2uccz+pXWgZzeKxDsDNMD/dJ6997/LSRY+W4NmEt9acwR+Gt9OHN0kkI1CTianCwoqcjQ==" crossorigin="anonymous"></script>

<!-- Lunr CDN -->
 <script src="https://unpkg.com/lunr@2.0.4/lunr.js"></script>

<!-- Firebase CDN -->
<script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="../../../css/style.css">

<!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-app.js"></script>

  <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
  <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-analytics.js"></script>

  <!-- Add Firebase products that you want to use -->
  <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-firestore.js"></script>


   

<!-- Java Script -->
<script src="../../../plugins/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<!-- Python highlighting -->
<script src="../../../plugins/prism/prism.js"></script>
<link href="../../../plugins/prism/prism.css" rel="stylesheet" />

<!-- Probability Packages -->
<script src="../../../js/probabilityUtils.js"></script>
<script src="../../../plugins/probability/gaussian.js"></script>
<script src="../../../plugins/color.js"></script>
<script src='https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js'></script>


<!-- font awesome -->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">

<!-- SWAL -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>


<!-- Stanford -->
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Source+Serif+Pro:400,600,700' rel='stylesheet' type='text/css'>
<link href="https://fonts.googleapis.com/css?family=Crimson+Text" rel="stylesheet">

<!-- Math Jax -->
<!-- <script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script> -->
<script type="text/javascript">
  MathJax = {
    config: ["MMLorHTML.js"],
    jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML"],
    extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js"],
    TeX: {
      extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js", "action.js"]
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    },
	"fast-preview": {
	  disabled: true
	}
  };
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>



<script src="../../../plugins/math.min.js"></script>



    <!-- Popper.JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

 <!-- Scrollbar Custom CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.min.css">
    <script src="../../../plugins/jquery.mCustomScrollbar.js"></script>

</head>

<script>
  Chart.defaults.font.family = 'Times New Roman';
  Chart.defaults.font.size = 18;
</script>


<!-- I declare a few math operators I often use in equations -->
<div style="display:none">
  $\DeclareMathOperator{\p}{P}$
  $\DeclareMathOperator{\P}{P}$
  $\DeclareMathOperator{\c}{^C}$
  $\DeclareMathOperator{\or}{  or}$
  $\DeclareMathOperator{\and}{  and}$
  $\DeclareMathOperator{\var}{Var}$
  $\DeclareMathOperator{\Var}{Var}$
  $\DeclareMathOperator{\Std}{Std}$
  $\DeclareMathOperator{\E}{E}$
  $\DeclareMathOperator{\std}{Std}$
  $\DeclareMathOperator{\Ber}{Bern}$
  $\DeclareMathOperator{\Bin}{Bin}$
  $\DeclareMathOperator{\Poi}{Poi}$
  $\DeclareMathOperator{\Uni}{Uni}$
  $\DeclareMathOperator{\Geo}{Geo}$
  $\DeclareMathOperator{\NegBin}{NegBin}$
  $\DeclareMathOperator{\Beta}{Beta}$
  $\DeclareMathOperator{\Exp}{Exp}$
  $\DeclareMathOperator{\N}{N}$
  $\DeclareMathOperator{\R}{\mathbb{R}}$
  $\DeclareMathOperator*{\argmax}{arg\,max}$
  $\newcommand{\d}{\, d}$
  
</div>

<body class="greyBackground">


    <div class="wrapper">
        <!-- Sidebar  -->
<nav id="sidebar">
    <div class="sidebar-header">
        <!-- <div></div> -->
        <a style="text-align:left" href="../../index.html"><h3></i> Probability<br/>For Computer Science<br/></h3></a>
    </div>

    <div> 
        <!-- Put a link back to cs109 -->
    

        <!-- This adds a search bar! -->
        <div class="searchCol" style="font-family: 'Source Sans Pro', sans-serif;">
            
            <input type="text" class="form-control bookSearch" id="probability-for-digital-world-search" aria-describedby="search box" placeholder="🔍 Search book..."/>
        </div>
        
    </div>

<!-- intro -->
<ul class="list-unstyled components">
<li>
<a id=sidebar-notation href="../../intro/notation">Notation Reference</a>
<a id=sidebar-core_probability_ref href="../../intro/core_probability_ref">Core Probability Reference</a>
<a id=sidebar-all_distributions href="../../intro/all_distributions">Random Variable Reference</a>
<a id=sidebar-python href="../../intro/python">Python Reference</a>
<a id=sidebar-calculators href="../../intro/calculators">Calculators</a>
</li>
</ul>

<!-- part1 -->
<ul class="list-unstyled components">
<li><p href="{pathToLang}part1">Part 1: Core Probability</p></li>
<li>
<a id=sidebar-counting href="../../part1/counting">Counting</a>
<a id=sidebar-combinatorics href="../../part1/combinatorics">Combinatorics</a>
<a id=sidebar-probability href="../../part1/probability">Definition of Probability</a>
<a id=sidebar-equally_likely href="../../part1/equally_likely">Equally Likely Outcomes</a>
<a id=sidebar-prob_or href="../../part1/prob_or">Probability of <b>or</b></a>
<a id=sidebar-cond_prob href="../../part1/cond_prob">Conditional Probability</a>
<a id=sidebar-independence href="../../part1/independence">Independence</a>
<a id=sidebar-prob_and href="../../part1/prob_and">Probability of <b>and</b></a>
<a id=sidebar-law_total href="../../part1/law_total">Law of Total Probability</a>
<a id=sidebar-bayes_theorem href="../../part1/bayes_theorem">Bayes' Theorem</a>
<a id=sidebar-log_probabilities href="../../part1/log_probabilities">Log Probabilities</a>
<a id=sidebar-many_flips href="../../part1/many_flips">Many Coin Flips</a>

<li>
    <a href="#part1_examples" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle show">Applications</a>
    <ul class="collapse list-unstyled show" id="part1_examples">
        <li><a href="../../examples/enigma">Enigma Machine</a></li><li><a href="../../examples/serendipity">Serendipity</a></li><li><a href="../../examples/random_shuffles">Random Shuffles</a></li><li><a href="../../examples/counting_graphs">Random Graphs</a></li><li><a href="../../examples/diversity_shapes">Set Diversity</a></li><li><a href="../../examples/bacteria_evolution">Bacteria Evolution</a></li>
    </ul>
</li>
</li>
</ul>

<!-- part2 -->
<ul class="list-unstyled components">
<li><p href="{pathToLang}part2">Part 2: Random Variables</p></li>
<li>
<a id=sidebar-rvs href="../../part2/rvs">Random Variables</a>
<a id=sidebar-pmf href="../../part2/pmf">Probability Mass Functions</a>
<a id=sidebar-expectation href="../../part2/expectation">Expectation</a>
<a id=sidebar-variance href="../../part2/variance">Variance</a>
<a id=sidebar-bernoulli href="../../part2/bernoulli">Bernoulli Distribution</a>
<a id=sidebar-binomial href="../../part2/binomial">Binomial Distribution</a>
<a id=sidebar-poisson href="../../part2/poisson">Poisson Distribution</a>
<a id=sidebar-more_discrete href="../../part2/more_discrete">More Discrete Distributions</a>
<a id=sidebar-categorical href="../../part2/categorical">Categorical Distributions</a>
<a id=sidebar-continuous href="../../part2/continuous">Continuous Distribution</a>
<a id=sidebar-uniform href="../../part2/uniform">Uniform Distribution</a>
<a id=sidebar-exponential href="../../part2/exponential">Exponential Distribution</a>
<a id=sidebar-normal href="../../part2/normal">Normal Distribution</a>
<a id=sidebar-binomial_approx href="../../part2/binomial_approx">Binomial Approximation</a>

<li>
    <a href="#part2_examples" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle show">Applications</a>
    <ul class="collapse list-unstyled show" id="part2_examples">
        <li><a href="../../examples/100_binomial_problems">100 Binomial Problems</a></li><li><a href="../../examples/winning_series">Winning Series</a></li><li><a href="../../examples/approximate_counting">Approximate Counting</a></li><li><a href="../../examples/jury">Jury Selection</a></li><li><a href="../../examples/grading_eye_inflammation">Grading Eye Inflamation</a></li><li><a href="../../examples/grades_not_normal">Grades are Not Normal</a></li><li><a href="../../examples/curse_of_dimensionality">Curse of Dimensionality</a></li><li><a href="../../examples/algorithmic_art">Algorithmic Art</a></li>
    </ul>
</li>
</li>
</ul>

<!-- part3 -->
<ul class="list-unstyled components">
<li><p href="{pathToLang}part3">Part 3: Probabilistic Models</p></li>
<li>
<a id=sidebar-joint href="../../part3/joint">Joint Probability</a>
<a id=sidebar-marginalization href="../../part3/marginalization">Marginalization</a>
<a id=sidebar-multinomial href="../../part3/multinomial">Multinomial</a>
<a id=sidebar-continuous_joint href="../../part3/continuous_joint">Continuous Joint</a>
<a id=sidebar-inference href="../../part3/inference">Inference</a>
<a id=sidebar-bayesian_networks href="../../part3/bayesian_networks">Bayesian Networks</a>
<a id=sidebar-independent_vars href="../../part3/independent_vars">Independence in Variables</a>
<a id=sidebar-correlation href="../../part3/correlation">Correlation</a>
<a id=sidebar-computational_inference href="../../part3/computational_inference">General Inference</a>

<li>
    <a href="#part3_examples" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle show">Applications</a>
    <ul class="collapse list-unstyled show" id="part3_examples">
        <li><a href="../../examples/fairness">Fairness in AI</a></li><li><a href="../../examples/federalist">Federalist Paper Authorship</a></li><li><a href="../../examples/name2age">Name to Age</a></li><li><a href="../../examples/prob_baby_delivery">Probability of Baby Delivery</a></li><li><a href="../../examples/bayesian_carbon_dating">Bayesian Carbon Dating</a></li><li><a href="../../examples/digital_vision_test">Digital Vision Test</a></li><li><a href="../../examples/bridge_distribution">Bridge Distribution</a></li><li><a href="../../examples/bayesian_viral_load_test">Bayesian Viral Load Test</a></li><li><a href="../../examples/dart_logo">CS109 Logo</a></li><li><a href="../../examples/tracking_in_2D">Tracking in 2D</a></li>
    </ul>
</li>
</li>
</ul>

<!-- part4 -->
<ul class="list-unstyled components">
<li><p href="{pathToLang}part4">Part 4: Uncertainty Theory</p></li>
<li>
<a id=sidebar-beta href="../../part4/beta">Beta Distribution</a>
<a id=sidebar-summation_vars href="../../part4/summation_vars">Adding Random Variables</a>
<a id=sidebar-clt href="../../part4/clt">Central Limit Theorem</a>
<a id=sidebar-samples href="../../part4/samples">Sampling</a>
<a id=sidebar-bootstrapping href="../../part4/bootstrapping">Bootstrapping</a>
<a id=sidebar-algorithmic_analysis href="../../part4/algorithmic_analysis">Algorithmic Analysis</a>
<a id=sidebar-information_theory href="../../part4/information_theory">Information Theory</a>

<li>
    <a href="#part4_examples" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle show">Applications</a>
    <ul class="collapse list-unstyled show" id="part4_examples">
        <li><a href="../../examples/thompson">Thompson Sampling</a></li><li><a href="../../examples/night_sight">Night Sight</a></li><li><a href="../../examples/p_hacking">P-Hacking</a></li><li><a href="../../examples/differential_privacy">Differential Privacy</a></li>
    </ul>
</li>
</li>
</ul>

<!-- part5 -->
<ul class="list-unstyled components">
<li><p href="{pathToLang}part5">Part 5: Machine Learning</p></li>
<li>
<a id=sidebar-parameter_estimation href="../../part5/parameter_estimation">Parameter Estimation</a>
<a id=sidebar-mle href="../../part5/mle">Maximum Likelihood Estimation</a>
<a id=sidebar-map href="../../part5/map">Maximum A Posteriori</a>
<a id=sidebar-machine_learning href="../../part5/machine_learning">Machine Learning</a>
<a id=sidebar-naive_bayes href="../../part5/naive_bayes">Naïve Bayes</a>
<a id=sidebar-log_regression href="../../part5/log_regression">Logistic Regression</a>

<li>
    <a href="#part5_examples" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle show">Applications</a>
    <ul class="collapse list-unstyled show" id="part5_examples">
        <li><a href="../../examples/mle_demo">MLE Normal Demo</a></li><li><a href="../../examples/mle_pareto">MLE Pareto Distribution</a></li><li><a href="../../examples/mixture_models">MLE Mixture Model</a></li>
    </ul>
</li>
</li>
</ul>



    <!-- <ul class="list-unstyled components">
        
         <li>
            <p>Part ?: Misfits</p>
        </li>
        <li>
             <a href="../../examples/probBabies.html">Probability and babies</a>
            
             <a href="../../">Sampling from a likelihood function</a>
             <a href="../../">Law of Total Expectation</a>
            
        </li>
    </ul> -->



    <ul class="list-unstyled CTAs">
        <li>
            Ⓒ Chris Piech, Stanford University
            <!-- <a href="https://compedu.stanford.edu/codeinplace/v1/#/course" class="download">Back to Code in Place</a> -->
        </li>
    </ul>
</nav>
        <!-- Page Content  -->
        <div id="content">

<button type="button" id="sidebarCollapse" class="mobile-only btn btn-dark exclude-from-print">
    <i class="fas fa-align-left"></i>
    <span></span>
</button>
            <!-- <button id="curiosityButton" onclick = "onCuriosity()" type="button" class="btn btn-primary btn-sm">
              <span style="font-size:150%">I'm Curious</span>
              <span></span>
          </button> -->
            
            <div class="container-fluid">
                <div class="row d-flex justify-content-center">
                    <div class="col handout" >
              
                        
 
<center><h1>Poisson Distribution</h1></center>
<hr/>

<p>A Poisson random variable gives the probability of a given number of events in a fixed interval of time (or space). It makes the Poisson assumption that  events occur with a known constant mean rate and independently of the time since the last event.
	</p>

<!-- Template that renders a single random variable card -->

<div class="bordered">
<p><b>Poisson Random Variable</b></p>


<table>
<tbody class="rvCardBody">
	<tr>
		<th style="width:150px">Notation:</td>
		<td>$X \sim \Poi(\lambda)$</td>
	</tr>
	<tr>
		<th>Description:</td>
		<td>Number of events in a fixed time frame if (a) the events occur with a constant mean rate and (b) they occur independently of time since last event.</td>
	</tr>
	<tr>
		<th>Parameters:</td>

		<td>$\lambda \in \mathbb{R}^{+}$, the constant average rate.</td>
	</tr>
	
	
	<tr>
		<th>Support:</td>
		<td>$x \in \{0, 1, \dots\}$</td>
	</tr>
	<tr>
		<th>PMF equation:</th>
		<td class="mathLeft">$$\p(X=x) = \frac{\lambda^xe^{-\lambda}}{x!}$$</td>
	</tr>
	<tr>
		<th>Expectation:</th>
		<td>$\E[X] = \lambda$</td>
	</tr>
	<tr>
		<th>Variance:</th>
		<td>$\var(X) = \lambda$</td>
	</tr>
	<tr>
		<th>PMF graph:</th>
	</tr>
</tbody>
</table>
<div class="d-flex">
	<div class="mr-2">
Parameter $\lambda$: <input onchange="redrawPoissonPmf()" type="number" class="form-control example-inline-input mb-3" id="poissonPmfLambda" min="1" max="130" value="5" step = "1">
</div>
</div>
<canvas id="poissonPmf" style="max-height: 400px"></canvas>
</div>

<script>

$(document).ready(function(){
	redrawPoissonPmf()
})

function redrawPoissonPmf() {
	let parentDivId = 'poissonPmf'
	let lambda = parseFloat($("#poissonPmfLambda").val())
	drawPoissonPmf(parentDivId, lambda)
}

function drawPoissonPmf(parentDivId, lambda) {
	if(window.myPoissonLine) {
		window.myPoissonLine.destroy()
	}

	console.log('lambda',lambda)
	var xValues = []
	var yValues = []
	var i = 0
	while(true){
		let pr_x = jStat.poisson.pdf(i, lambda).toFixed(5)
		xValues.push(i)
		yValues.push(pr_x)
		console.log(i, pr_x)
		i += 1
		if(pr_x < 0.00001 && i > lambda) {
			break;
		}
	}
	console.log(xValues, yValues)
	let xLabel = 'Values that X can take on'
	let yLabel = 'Probability'

	var config = standardPMFConfig(xValues, yValues, xLabel, yLabel)
	var ctx = document.getElementById(parentDivId).getContext('2d');
	window.myPoissonLine = new Chart(ctx, config);
}
</script>
<h2>Poisson Intuition</h2>

<p>In this section we show the intuition behind the Poisson derivation. It is both a great way to deeply understand the Poisson, as well as good practice with Binomial distributions.</p>

<p>Let's work on the problem of predicting the chance of a given number of events occurring in a fixed time interval &mdash; the next minute. For example, imagine you are working on a ride sharing application and you care about the probability of how many requests you get from a particular area. From historical data, you know that the average requests per minute is $\lambda = 5$. What is the probability of getting 1, 2, 3, etc requests in a minute?</p>

<p><i class="fas fa-lightbulb"></i>: We could approximate a solution to this problem by using a binomial distribution! Lets say we split our minute into 60 seconds, and make each second an <a href="../../part2/bernoulli">indicator Bernoulli</a> variable &mdash; you either get a request or you don't. If you get a request in a second, the indicator is 1. Otherwise it is 0. Here is a visualization of our 60 binary-indicators. In this example imagine we have requests at 2.75 and 7.12 seconds. the corresponding indicator variables are  <span class="blue">blue</span> filled in boxes:</p>
	<center>1 minute</center>
<div id="poissonTimeSec" class="d-flex mb-3" style="width:100%; border-style: solid; border-width: thin; height:50px">
</div>

<p>
	The total number of requests received over the minute can be approximated as the sum of the sixty indicator variables, which conveniently matches the description of a <a href="../../part2/binomial">binomial</a> &mdash; a sum of Bernoullis. Specifically define $X$ to be the number of requests in a minute. $X$ is a binomial with $n=60$ trials. What is the probability, $p$, of a success on a single trial? To make the expectation of $X$ equal the observed historical average $\lambda =5$ we should choose $p$ so that $\lambda = \E[X]$. 
	$$
	\begin{align}
	\lambda &= \E[X] && \text{Expectation matches historical average} \\
	\lambda &= n \cdot p && \text{Expectation of a Binomial is } n \cdot p \\
	p &= \frac{\lambda}{n} && \text{Solving for $p$}
	\end{align}
	$$
	In this case since $\lambda=5$ and $n=60$, we should choose $p=5/60$ and state that $X \sim \Bin(n=60, p=5/60)$. Now that we have a form for $X$ we can answer probability questions about the number of requests by using the Binomial PMF:

	$$\p(X = x) = {n \choose x} p^x (1-p)^{n-x}$$
	<center>So for example:</center>
	$$\p(X=1) = {60 \choose 1} (5/60)^1 (55/60)^{60-1} \approx 0.0295$$
	$$\p(X=2) = {60 \choose 2} (5/60)^2 (55/60)^{60-2} \approx 0.0790$$
	$$\p(X=3) = {60 \choose 3} (5/60)^3 (55/60)^{60-3} \approx 0.1389$$
	</p>


	Great! But don't forget that this was an approximation. We didn't account for the fact that there can be more than one event in a single second. One way to assuage this issue is to divide our minute into more fine-grained intervals (the choice to split it into 60 seconds was rather arbitrary). Instead lets divide our minute into 600 deciseconds, again with requests at 2.75 and 7.12 seconds:
	<center>1 minute</center>
<div id="poissonTimeDecaSec" class="d-flex mb-3" style="width:100%; border-style: solid; border-width: thin; height:50px">
</div>

<p>
Now $n=600$, $p=5/600$ and $X \sim \Bin(n=600, p=6/600)$. We can repeat our example calculations using this better approximation:
$$\p(X=1) = {600 \choose 1} (5/600)^1 (595/60)^{600-1} \approx 0.0333$$
	$$\p(X=2) = {600 \choose 2} (5/600)^2 (595/600)^{600-2} \approx 0.0837$$
	$$\p(X=3) = {600 \choose 3} (5/600)^3 (595/600)^{600-3} \approx 0.1402$$
</p>

<div class="purpleBox">
<p>Choose any value of $n$, the number of buckets to divide our minute into: <input onchange="recalculatePoi()" type="number" class="form-control example-inline-input" id="poiInput" style="width:100px" value="0" step = "6000">
<span id="poiResults">
</span>

</p>
<!-- script to update the example -->
<script>
$( document ).ready(function() {
	// recalculatePoi()
});

function recalculatePoi() {
	let lambda = 5
	let n = parseFloat($("#poiInput").val())
	let p = `${lambda}/${n}`
	let q = `${n-lambda}/${n}`
	let html = `
	$$X \\sim \\Bin(n=${n},p=${p})$$
	$$\\p(X=1) = {${n} \\choose 1} (${p})^1 (${q})^{${n}-1} \\approx ${pr(n,1)}$$
	$$\\p(X=2) = {${n} \\choose 2} (${p})^2 (${q})^{${n}-2} \\approx ${pr(n,2)}$$
	$$\\p(X=3) = {${n} \\choose 3} (${p})^3 (${q})^{${n}-3} \\approx ${pr(n,3)}$$
	`
	$("#poiResults").html(html)
	MathJax.typeset()
}

function pr(n, x) {
	let p = 5/n
	return binomialPmf(n,p,x).toFixed(5)
}

</script>
</div>

<p>The larger $n$ is, the more accurate the approximation. So what happens when $n$ is infinity? It becomes a Poisson!</p>

<h2>Poisson, a Binomial in the limit</h2>

<p>Or if we really cared about making sure that we don't get two events in the same bucket, we can divide our minute into infinitely small buckets:
	<center>1 minute</center>
<div id="poissonTimeMilliSec" class="d-flex mb-3" style="width:100%; border-style: solid; border-width: thin; height:50px">
</div>
<p>
<div class="bordered">
	<p><b><i>Proof</i></b>: Derivation of the Poisson</p>
<p>
	What does the PMF of $X$ look like now that we have infinite divisions of our minute? We can write the equation and think about it as $n$ goes to infinity. Recall that $p$ still equals $\lambda/n$:
	</p>

	$$
	\P(X=x) = \lim_{n \rightarrow \infty} {n \choose x} (\lambda / n)^x(1-\lambda/n)^{n-x}
	$$
<p>
	While it may look intimidating, this expression simplifies nicely. This proof uses a few special limit rules that we haven't introduced in this book:
</p>

$$
\begin{align}
	\P(X=x) 
	&= \lim_{n \rightarrow \infty} {n \choose x} (\lambda / n)^x(1-\lambda/n)^{n-x}
		&& \text{Start: binomial in the limit}\\
	&= \lim_{n \rightarrow \infty}
		{n \choose x} \cdot
		\frac{\lambda^x}{n^x} \cdot
		\frac{(1-\lambda/n)^{n}}{(1-\lambda/n)^{x}} 
		&& \text{Expanding the power terms} \\
	&= \lim_{n \rightarrow \infty}
		\frac{n!}{(n-x)!x!} \cdot
		\frac{\lambda^x}{n^x} \cdot
		\frac{(1-\lambda/n)^{n}}{(1-\lambda/n)^{x}} 
		&& \text{Expanding the binomial term} \\
	&= \lim_{n \rightarrow \infty}
		\frac{n!}{(n-x)!x!} \cdot
		\frac{\lambda^x}{n^x} \cdot
		\frac{e^{-\lambda}}{(1-\lambda/n)^{x}} 
		&& \href{http://www.sosmath.com/calculus/sequence/specialim/specialim.html}{\text{Rule }} \lim_{n \rightarrow \infty}(1-\lambda/n)^{n} = e^{-\lambda}\\
	&= \lim_{n \rightarrow \infty}
		\frac{n!}{(n-x)!x!} \cdot
		\frac{\lambda^x}{n^x} \cdot
		\frac{e^{-\lambda}}{1} 
		&& \href{https://www.youtube.com/watch?v=x1WBTBtfvjM}{\text{Rule }} \lim_{n \rightarrow \infty}\lambda/n= 0\\
	&= \lim_{n \rightarrow \infty}
		\frac{n!}{(n-x)!} \cdot
		\frac{1}{x!} \cdot
		\frac{\lambda^x}{n^x} \cdot
		\frac{e^{-\lambda}}{1} 
		&& \text{Splitting first term}\\
	&= \lim_{n \rightarrow \infty}
		\frac{n^x}{1} \cdot
		\frac{1}{x!} \cdot
		\frac{\lambda^x}{n^x} \cdot
		\frac{e^{-\lambda}}{1} 
		&& \lim_{n \rightarrow \infty }\frac{n!}{(n-x)!} = n^x\\
	&= \lim_{n \rightarrow \infty}
		\frac{\lambda^x}{x!} \cdot
		\frac{e^{-\lambda}}{1} 
		&& \text{Cancel }n^x\\
	&= 
		\frac{\lambda^x \cdot e^{-\lambda}}{x!} 
		&& \text{Simplify}\\
\end{align}
	$$
</div>
</p>

<p>That is a beautiful expression! Now we can calculate the real probability of number of requests in a minute, if the historical average is $\lambda=5$:</p>

<p>
$$\p(X=1) =  \frac{5^1 \cdot e^{-5}}{1!} = 0.03369$$
	$$\p(X=2) = \frac{5^2 \cdot e^{-5}}{2!}= 0.08422$$
	$$\p(X=3) =  \frac{5^3 \cdot e^{-5}}{3!} = 0.14037$$
</p>

<p>This is both more accurate and much easier to compute!</p>


<h2>Changing time frames</h2>

<p>Say you are given a rate over one unit of time, but you want to know the rate in another unit of time. For example, you may be given the rate of hits to a website per minute, but you want to know the probability over a 20 minute period. You would just need to multiply this rate by 20 in order to go from the "per 1 minute of time" rate to obtain the "per 20 minutes of time" rate.


<style>
.poiBox {
	border-right-style: solid; 
	border-width: thin; 
	height:48px;
	border-color: #ccc;
}

.poiBoxLast {
	border-left-style: solid; 
	border-width: thin; 
	height:49px;
	border-color: #ccc;
}

.poiFillBox {
	height:48px;
	background-color: #dedede;
	width:60%;
}

#poissonTimeMilliSec {
	position: relative;
}

.infEvent{
	height:49px;
	width:1px;
	background-color: blue;
	position: absolute;
}

</style>


<script>
let EVENTS_S = [2.75, 7.12]

$( document ).ready(function() {
    makePoissonTime('poissonTimeSec', 60, 0.6, 9)
    makePoissonTime('poissonTimeDecaSec', 600, 0.6, 90)
    makePoissonTimeFilled('poissonTimeMilliSec', 0.6)
});

function makePoissonTimeFilled(parentId, fillPct) {

	// 60% is 9 seconds
	let parentDiv = $("#" + parentId)
	let x = parentDiv.append(`<div class="poiFillBox"></div>`)
	let parentWidth = parentDiv.width()
	let pixelsPerSecond = (parentWidth * .6) / 9
	for (var i = 0; i < EVENTS_S.length; i++) {
		let event = EVENTS_S[i]
		let left = event * pixelsPerSecond
		console.log('left', i, left)
		x.append(`<div class="infEvent" style="left:${left}px"/>`)
	}
}

function makePoissonTime(parentId, n, workPct, showN) {
	let parentDiv = $("#" + parentId)
	let workingWidth = parentDiv.width() * workPct
	console.log('showN', showN)
	let boxWidth = workingWidth / showN
	console.log('boxWidth', boxWidth)
	// draw the 80% of boxes
	for (var i = 0; i < showN; i++) {
		let minTime = i * (60/n)
		let maxTime = (i+1)*(60/n)
		let fillColor = 'white'
		if(isEvent(minTime, maxTime)) {
			fillColor = 'blue'
		}
		parentDiv.append(`<div class="poiBox" style="width:${boxWidth}px;background-color:${fillColor};"></div>`)
	}

	// draw the tripple dot
	parentDiv.append(`<div style="line-height:49px;flex-grow: 4;"><center>···</center></div>`)

	// draw the one remaining
	parentDiv.append(`<div class="poiBoxLast" style="width:${boxWidth}px;"></div>`)

}

function isEvent(minTime, maxTime) {
	for (var i = 0; i < EVENTS_S.length; i++) {
		let event = EVENTS_S[i]
		if(event > minTime && event <= maxTime) {
			return true
		}
	}
	return false
}
</script>


                        



<script type="text/javascript">
    // const firebase = require("firebase");
    // Required for side-effects
    // require("firebase/firestore");

    $(document).ready(function () {
        console.log('ready')
        const scrollTop = getScrollTop()
        console.log(scrollTop)
        $("#sidebar").scrollTop(scrollTop)
        $("#sidebar").scroll(function() {
          localStorage.scrollTop = $("#sidebar").scrollTop()
        })
        // $("#sidebar").mCustomScrollbar({
        //     theme: "minimal",
        //     mouseWheel: {preventDefault: true},
        //     advanced:{
        //      autoScrollOnFocus: false,
        //      updateOnContentResize: true
        //     },
        //     scrollInertia:0,
        //     contentTouchScroll:1,
        //     mouseWheel: {
        //         scrollAmount:1000
        //     },
        //     setTop:scrollTop + 'px',
        //     callbacks:{
        //         onScroll:function(){
        //             if(hasStorage) {

        //                 localStorage.scrollTop = this.mcs.top;
        //                 console.log(localStorage.scrollTop)
        //             }
        //         }
        //     } 
        // });

        $('#sidebarCollapse').on('click', function () {
            $('#sidebar, #content').toggleClass('active');
            $('.collapse.in').toggleClass('in');
            $('a[aria-expanded=true]').attr('aria-expanded', 'false');
        });

        
        let lastPart = getUrlKey()
        
        // Bug: this code will highlight anything which matches with the last part
        $("#sidebar").find('a').each(function(){
            // find link which ends with last part and add style
            let currLink = $($(this)[0]).attr('href')
            let currLastPart = getLastPartOfUrl(currLink)
            if (currLastPart === lastPart) {
                $($(this)[0]).addClass('active-link');
            }
        })
    });

    function getScrollTop() {
        if(typeof(Storage) !== "undefined") {
            return Number(localStorage.scrollTop)
        }
        return 0;
    }

    function getUrlKey() {
        var path = window.location.pathname;
        return getLastPartOfUrl(path)
        
    }

    function getLastPartOfUrl(path) {
        let parts = path.split('/')
        var currIndex = parts.length - 1
        while(currIndex >= 0) {
            let nextPart = parts[currIndex]
            if(nextPart) {
                return nextPart
            }
            currIndex -= 1
        }
        return ''
    }

    function submitQuestion() {
        firebase.initializeApp({
          apiKey: "AIzaSyBqZVV7Qrp0DT3aBCCTCTMUCrPJO0pb3tY",
          authDomain: "probability-digital-world.firebaseapp.com",
          projectId: "probability-digital-world"
        });

        var db = firebase.firestore();

        db.collection("questions").add({
            email: $("#question-email").val(),
            question: "Lovelace",
            page: getUrlKey()
        })
        .then(function(docRef) {
            console.log("Document written with ID: ", docRef.id);
            alert('success')
        })
        .catch(function(error) {
            console.error("Error adding document: ", error);
        });
        // // // Generate a new push ID for the new post
        // var questionListRef = db.child("questions")
        // var newQuestionRef = questionListRef.push();
        // newQuestionRef.set({
        //     'title':'test'
        // });
        
    }

    function onCuriosity() {
        Swal.fire({
          title: 'Curious?',
          position: 'bottom-end',
          allowOutsideClick:false,
          backdrop:false,
          confirmButtonText: 'Submit',
          input: 'textarea',
          html:
            '<p>We are trying to make this book better. Let us know if you find something confusing. If you ask a question we will try to answer it. If you find a mistake we will fix it. </p>' +
            '<input placeholder="Your email (optional)..." id="question-email" class="swal2-input">',
          inputPlaceholder: 'Type your question or message here...',
          inputAttributes: {
            'aria-label': 'Type your question or message here'
          },
          showCancelButton: true,
          preConfirm: () => submitQuestion()
        })
    }
</script>

                         <br/><br/>
                
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>

$(document).ready(function() {
  //addH2Numbers()
  enableSearch()
})

function addH2Numbers() {
  $("h2").each(function(i){
    let title = $(this).html()
    title = `${i+1}. ${title}`
    $(this).html(title)
  })
}

function enableSearch() {
  $("#probability-for-digital-world-search").on('keyup', function (e) {
      if (e.key === 'Enter' || e.keyCode === 13) {
          let query = $("#probability-for-digital-world-search").val()
          
          window.location = `../../search.html?q=${query}`
      }
  });
  // $.ajax({
  //     type: "GET",
  //     url: "../../../searchIndex.json",
  //     dataType: "text",
  //     success: function(data) {addSearchIndexData(data);}
  //  });
}

function standardPMFConfig(xValues, yValues, xLabel, yLabel){
  return {
    type: 'bar',
    data: {
      labels: xValues,
      datasets: [{
        label: 'P(x)',
        fill: false,
        backgroundColor: 'blue',
        borderColor: 'blue',
        data: yValues,
        pointRadius:1,
        maxBarThickness:100,
        pointHitRadius: 20
      }]
    },
    options: {

      steppedLine: false,
      responsive: true,
      tooltips: {
        mode: 'index',
        intersect: false,
      },
      hover: {
        mode: 'nearest',
        intersect: true
      },
      animation: {
            duration: 0
        },
      plugins: {
        legend: {
              display: false
           },
         },
      scales: {
        x: {
          display: true,
          type: 'linear',
          title: {
            display: true,
            text: xLabel
          }
        },
        y: {
          display: true,
          title: {
            display: true,
            text: yLabel
          },
          ticks: {
            beginAtZero: true
          }
        }
      }
    }
  };
}

function standardPDFConfig(xValues, yValues, xLabel, yLabel){
  return {
    type: 'line',
    data: {
      labels: xValues,
      datasets: [{
        label: 'f(x)',
        fill: false,
        backgroundColor: 'blue',
        borderColor: 'blue',
        data: yValues,
        pointRadius:1,
        maxBarThickness:100,
        pointHitRadius: 20
      }]
    },
    options: {
      steppedLine: false,
      responsive: true,
      tooltips: {
        mode: 'index',
        intersect: false,
      },
      hover: {
        mode: 'nearest',
        intersect: true
      },
      animation: {
            duration: 0
        },
      plugins: {
        legend: {
              display: false
           },
         },
      scales: {
        x: {
          display: true,
          type: 'linear',
          title: {
            display: true,
            text: xLabel
          }
        },
        y: {
          display: true,
          title: {
            display: true,
            text: yLabel
          },
          ticks: {
            beginAtZero: true
          }
        }
      }
    }
  };
}

function standardPDFsConfig(datasets, xValues, xLabel, yLabel){
  return {
    type: 'line',
    data: {
      datasets: datasets
    },
    options: {

      steppedLine: false,
      responsive: true,
      tooltips: {
        mode: 'index',
        intersect: false,
      },
      hover: {
        mode: 'nearest',
        intersect: true
      },
      animation: {
            duration: 0
        },
      plugins: {
        legend: {
              display: false
           },
         },
      scales: {
        x: {
          display: true,
          type: 'linear',
          title: {
            display: true,
            text: xLabel
          }
        },
        y: {
          display: true,
          title: {
            display: true,
            text: yLabel
          },
          ticks: {
            beginAtZero: true
          }
        }
      }
    }
  };
}


function addSearchIndexData(data) {
  var idx = lunr(function () {
    this.ref('name')
    this.field('text')

    let documents = JSON.parse(data)

    documents.forEach(function (doc) {
      this.add(doc)
    }, this)

    $("#probability-for-digital-world-search").on('keyup', function (e) {
        if (e.key === 'Enter' || e.keyCode === 13) {
            let query = $("#probability-for-digital-world-search").val()
            let results = idx.search(query)
        }
    });
  })
}

    </script>

</body>




</html>