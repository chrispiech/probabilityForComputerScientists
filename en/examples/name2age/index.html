
<!DOCTYPE html>
<html>

<head>
    

<title>Name to Age</title>

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta http-equiv="content-type" content="text/html; charset=UTF8">

<link rel="shortcut icon" type="image/x-icon" href="../../../favicon.ico">

<!-- Python highlighting -->
<script src="../../../plugins/prism/prism.js"></script>
<link href="../../../plugins/prism/prism.css" rel="stylesheet" />

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" integrity="sha512-uto9mlQzrs59VwILcLiRYeLKPPbS/bT71da/OEBYEwcdNUk8jYIy+D176RYoop1Da+f9mvkYrmj5MCLZWEtQuA==" crossorigin="anonymous"></script>
 <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.css" rel="Stylesheet" type="text/css" />

<!-- D3 CDN -->
<script src="https://d3js.org/d3.v3.js"></script>
<!-- <script src="https://d3js.org/d3.v4.js"></script> -->
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

<!-- Chart CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.6.0/dist/chart.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/1.0.2/chartjs-plugin-annotation.min.js" integrity="sha512-FuXN8O36qmtA+vRJyRoAxPcThh/1KJJp7WSRnjCpqA+13HYGrSWiyzrCHalCWi42L5qH1jt88lX5wy5JyFxhfQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<!-- PDF JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.min.js" integrity="sha512-Z8CqofpIcnJN80feS2uccz+pXWgZzeKxDsDNMD/dJ6997/LSRY+W4NmEt9acwR+Gt9OHN0kkI1CTianCwoqcjQ==" crossorigin="anonymous"></script>

<!-- Lunr CDN -->
 <script src="https://unpkg.com/lunr@2.0.4/lunr.js"></script>

<!-- Firebase CDN -->
<script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="../../../css/style.css">

<!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-app.js"></script>

  <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
  <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-analytics.js"></script>

  <!-- Add Firebase products that you want to use -->
  <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-firestore.js"></script>


   

<!-- Java Script -->
<script src="../../../plugins/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<!-- Python highlighting -->
<script src="../../../plugins/prism/prism.js"></script>
<link href="../../../plugins/prism/prism.css" rel="stylesheet" />

<!-- Probability Packages -->
<script src="../../../js/probabilityUtils.js"></script>
<script src="../../../plugins/probability/gaussian.js"></script>
<script src="../../../plugins/color.js"></script>
<script src='https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js'></script>


<!-- font awesome -->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">

<!-- SWAL -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>


<!-- Stanford -->
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Source+Serif+Pro:400,600,700' rel='stylesheet' type='text/css'>
<link href="https://fonts.googleapis.com/css?family=Crimson+Text" rel="stylesheet">

<!-- Math Jax -->
<!-- <script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script> -->
<script type="text/javascript">
  MathJax = {
    config: ["MMLorHTML.js"],
    jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML"],
    extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js"],
    TeX: {
      extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js", "action.js"]
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    },
	"fast-preview": {
	  disabled: true
	}
  };
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>



<script src="../../../plugins/math.min.js"></script>



    <!-- Popper.JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

 <!-- Scrollbar Custom CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.min.css">
    <script src="../../../plugins/jquery.mCustomScrollbar.js"></script>

</head>

<script>
  Chart.defaults.font.family = 'Times New Roman';
  Chart.defaults.font.size = 18;
</script>


<!-- I declare a few math operators I often use in equations -->
<div style="display:none">
  $\DeclareMathOperator{\p}{P}$
  $\DeclareMathOperator{\P}{P}$
  $\DeclareMathOperator{\c}{^C}$
  $\DeclareMathOperator{\or}{  or}$
  $\DeclareMathOperator{\and}{  and}$
  $\DeclareMathOperator{\var}{Var}$
  $\DeclareMathOperator{\Var}{Var}$
  $\DeclareMathOperator{\Std}{Std}$
  $\DeclareMathOperator{\E}{E}$
  $\DeclareMathOperator{\std}{Std}$
  $\DeclareMathOperator{\Ber}{Bern}$
  $\DeclareMathOperator{\Bin}{Bin}$
  $\DeclareMathOperator{\Poi}{Poi}$
  $\DeclareMathOperator{\Uni}{Uni}$
  $\DeclareMathOperator{\Geo}{Geo}$
  $\DeclareMathOperator{\NegBin}{NegBin}$
  $\DeclareMathOperator{\Beta}{Beta}$
  $\DeclareMathOperator{\Exp}{Exp}$
  $\DeclareMathOperator{\N}{N}$
  $\DeclareMathOperator{\R}{\mathbb{R}}$
  $\DeclareMathOperator*{\argmax}{arg\,max}$
  $\newcommand{\d}{\, d}$
  
</div>

<body class="greyBackground">


    <div class="wrapper">
        <!-- Sidebar  -->
<nav id="sidebar">
    <div class="sidebar-header">
        <!-- <div></div> -->
        <a style="text-align:center" href="../../index.html"><h3><i class="fas fa-book-open"></i><br/> Course Reader for <br/>CS109<br/></h3></a>
    </div>

    <div> 
        <!-- Put a link back to cs109 -->
    

        <!-- This adds a search bar! -->
        <div class="searchCol" style="font-family: 'Source Sans Pro', sans-serif;">
            
            <input type="text" class="form-control bookSearch" id="probability-for-digital-world-search" aria-describedby="search box" placeholder="üîç Search book..."/>
        </div>
        
    </div>

<!-- intro -->
<ul class="list-unstyled components">
<li>
<a id=sidebar-notation href="../../intro/notation">Notation Reference</a>
<a id=sidebar-core_probability_ref href="../../intro/core_probability_ref">Core Probability Reference</a>
<a id=sidebar-all_distributions href="../../intro/all_distributions">Random Variable Reference</a>
<a id=sidebar-python href="../../intro/python">Python Reference</a>
<a id=sidebar-calculators href="../../intro/calculators">Calculators</a>
</li>
</ul>

<!-- part1 -->
<ul class="list-unstyled components">
<li><p href="{pathToLang}part1">Part 1: Core Probability</p></li>
<li>
<a id=sidebar-counting href="../../part1/counting">Counting</a>
<a id=sidebar-combinatorics href="../../part1/combinatorics">Combinatorics</a>
<a id=sidebar-probability href="../../part1/probability">Definition of Probability</a>
<a id=sidebar-equally_likely href="../../part1/equally_likely">Equally Likely Outcomes</a>
<a id=sidebar-prob_or href="../../part1/prob_or">Probability of <b>or</b></a>
<a id=sidebar-cond_prob href="../../part1/cond_prob">Conditional Probability</a>
<a id=sidebar-independence href="../../part1/independence">Independence</a>
<a id=sidebar-prob_and href="../../part1/prob_and">Probability of <b>and</b></a>
<a id=sidebar-law_total href="../../part1/law_total">Law of Total Probability</a>
<a id=sidebar-bayes_theorem href="../../part1/bayes_theorem">Bayes' Theorem</a>
<a id=sidebar-log_probabilities href="../../part1/log_probabilities">Log Probabilities</a>
<a id=sidebar-many_flips href="../../part1/many_flips">Many Coin Flips</a>

<li>
    <a href="#part1_examples" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle show">Applications</a>
    <ul class="collapse list-unstyled show" id="part1_examples">
        <li><a href="../../examples/enigma">Enigma Machine</a></li><li><a href="../../examples/serendipity">Serendipity</a></li><li><a href="../../examples/random_shuffles">Random Shuffles</a></li><li><a href="../../examples/counting_graphs">Random Graphs</a></li><li><a href="../../examples/bacteria_evolution">Bacteria Evolution</a></li>
    </ul>
</li>
</li>
</ul>

<!-- part2 -->
<ul class="list-unstyled components">
<li><p href="{pathToLang}part2">Part 2: Random Variables</p></li>
<li>
<a id=sidebar-rvs href="../../part2/rvs">Random Variables</a>
<a id=sidebar-pmf href="../../part2/pmf">Probability Mass Functions</a>
<a id=sidebar-expectation href="../../part2/expectation">Expectation</a>
<a id=sidebar-variance href="../../part2/variance">Variance</a>
<a id=sidebar-bernoulli href="../../part2/bernoulli">Bernoulli Distribution</a>
<a id=sidebar-binomial href="../../part2/binomial">Binomial Distribution</a>
<a id=sidebar-poisson href="../../part2/poisson">Poisson Distribution</a>
<a id=sidebar-more_discrete href="../../part2/more_discrete">More Discrete Distributions</a>
<a id=sidebar-categorical href="../../part2/categorical">Categorical Distributions</a>
<a id=sidebar-continuous href="../../part2/continuous">Continuous Distribution</a>
<a id=sidebar-uniform href="../../part2/uniform">Uniform Distribution</a>
<a id=sidebar-exponential href="../../part2/exponential">Exponential Distribution</a>
<a id=sidebar-normal href="../../part2/normal">Normal Distribution</a>
<a id=sidebar-binomial_approx href="../../part2/binomial_approx">Binomial Approximation</a>

<li>
    <a href="#part2_examples" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle show">Applications</a>
    <ul class="collapse list-unstyled show" id="part2_examples">
        <li><a href="../../examples/100_binomial_problems">100 Binomial Problems</a></li><li><a href="../../examples/winning_series">Winning Series</a></li><li><a href="../../examples/approximate_counting">Approximate Counting</a></li><li><a href="../../examples/jury">Jury Selection</a></li><li><a href="../../examples/prob_baby_delivery">Probability of Baby Delivery</a></li><li><a href="../../examples/grading_eye_inflammation">Grading Eye Inflamation</a></li><li><a href="../../examples/grades_not_normal">Grades are Not Normal</a></li><li><a href="../../examples/curse_of_dimensionality">Curse of Dimensionality</a></li><li><a href="../../examples/algorithmic_art">Algorithmic Art</a></li>
    </ul>
</li>
</li>
</ul>

<!-- part3 -->
<ul class="list-unstyled components">
<li><p href="{pathToLang}part3">Part 3: Probabilistic Models</p></li>
<li>
<a id=sidebar-joint href="../../part3/joint">Joint Probability</a>
<a id=sidebar-marginalization href="../../part3/marginalization">Marginalization</a>
<a id=sidebar-multinomial href="../../part3/multinomial">Multinomial</a>
<a id=sidebar-continuous_joint href="../../part3/continuous_joint">Continuous Joint</a>
<a id=sidebar-inference href="../../part3/inference">Inference</a>
<a id=sidebar-bayesian_networks href="../../part3/bayesian_networks">Bayesian Networks</a>
<a id=sidebar-independent_vars href="../../part3/independent_vars">Independence in Variables</a>
<a id=sidebar-correlation href="../../part3/correlation">Correlation</a>
<a id=sidebar-computational_inference href="../../part3/computational_inference">General Inference</a>

<li>
    <a href="#part3_examples" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle show">Applications</a>
    <ul class="collapse list-unstyled show" id="part3_examples">
        <li><a href="../../examples/fairness">Fairness in AI</a></li><li><a href="../../examples/federalist">Federalist Paper Authorship</a></li><li><a href="../../examples/name2age">Name to Age</a></li><li><a href="../../examples/bayesian_carbon_dating">Bayesian Carbon Dating</a></li><li><a href="../../examples/digital_vision_test">Digital Vision Test</a></li><li><a href="../../examples/bridge_distribution">Bridge Distribution</a></li><li><a href="../../examples/bayesian_viral_load_test">Bayesian Viral Load Test</a></li><li><a href="../../examples/dart_logo">CS109 Logo</a></li><li><a href="../../examples/tracking_in_2D">Tracking in 2D</a></li>
    </ul>
</li>
</li>
</ul>

<!-- part4 -->
<ul class="list-unstyled components">
<li><p href="{pathToLang}part4">Part 4: Uncertainty Theory</p></li>
<li>
<a id=sidebar-beta href="../../part4/beta">Beta Distribution</a>
<a id=sidebar-summation_vars href="../../part4/summation_vars">Adding Random Variables</a>
<a id=sidebar-clt href="../../part4/clt">Central Limit Theorem</a>
<a id=sidebar-samples href="../../part4/samples">Sampling</a>
<a id=sidebar-bootstrapping href="../../part4/bootstrapping">Bootstrapping</a>
<a id=sidebar-algorithmic_analysis href="../../part4/algorithmic_analysis">Algorithmic Analysis</a>

<li>
    <a href="#part4_examples" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle show">Applications</a>
    <ul class="collapse list-unstyled show" id="part4_examples">
        <li><a href="../../examples/thompson">Thompson Sampling</a></li><li><a href="../../examples/night_sight">Night Sight</a></li><li><a href="../../examples/p_hacking">P-Hacking</a></li><li><a href="../../examples/differential_privacy">Differential Privacy</a></li>
    </ul>
</li>
</li>
</ul>

<!-- part5 -->
<ul class="list-unstyled components">
<li><p href="{pathToLang}part5">Part 5: Machine Learning</p></li>
<li>
<a id=sidebar-parameter_estimation href="../../part5/parameter_estimation">Parameter Estimation</a>
<a id=sidebar-mle href="../../part5/mle">Maximum Likelihood Estimation</a>
<a id=sidebar-map href="../../part5/map">Maximum A Posteriori</a>
<a id=sidebar-machine_learning href="../../part5/machine_learning">Machine Learning</a>
<a id=sidebar-naive_bayes href="../../part5/naive_bayes">Na√Øve Bayes</a>
<a id=sidebar-log_regression href="../../part5/log_regression">Logistic Regression</a>

<li>
    <a href="#part5_examples" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle show">Applications</a>
    <ul class="collapse list-unstyled show" id="part5_examples">
        <li><a href="../../examples/mle_demo">MLE Normal Demo</a></li><li><a href="../../examples/mle_pareto">MLE Pareto Distribution</a></li><li><a href="../../examples/mixture_models">MLE Mixture Model</a></li>
    </ul>
</li>
</li>
</ul>



    <!-- <ul class="list-unstyled components">
        
         <li>
            <p>Part ?: Misfits</p>
        </li>
        <li>
             <a href="../../examples/probBabies.html">Probability and babies</a>
            
             <a href="../../">Sampling from a likelihood function</a>
             <a href="../../">Law of Total Expectation</a>
            
        </li>
    </ul> -->



    <ul class="list-unstyled CTAs">
        <li>
            ‚í∏ Chris Piech, Stanford University
            <!-- <a href="https://compedu.stanford.edu/codeinplace/v1/#/course" class="download">Back to Code in Place</a> -->
        </li>
    </ul>
</nav>
        <!-- Page Content  -->
        <div id="content">

<button type="button" id="sidebarCollapse" class="mobile-only btn btn-dark exclude-from-print">
    <i class="fas fa-align-left"></i>
    <span></span>
</button>
            <!-- <button id="curiosityButton" onclick = "onCuriosity()" type="button" class="btn btn-primary btn-sm">
              <span style="font-size:150%">I'm Curious</span>
              <span></span>
          </button> -->
            
            <div class="container-fluid">
                <div class="row d-flex justify-content-center">
                    <div class="col handout" >
              
                        
 
<center><h1>Name to Age</h1></center>
<hr/>

<p>
Because of shifting patterns in name popularity, a person's name is a hint as to their age. The United States publishes a data which contains counts of how many US residents were born with a given name in a given year, based off Social Security applications. We can use inference to compute the reverse probability distribution: an updated belief in a person's age, given their name. As a reminder, if I know the year someone was born, I can calculate their age within one year.


<p><div class="content">
Query Name: <input onchange="runName2Age()" class="form-control" value="Katherine" id="queryName" style="display:inline-block;width:200px"> <span id="inputStatus"></span>
  </div></p>

  <div class="loader" id="dataLoader"></div>
  <canvas id="babyNamePMF" style="max-height: 400px;display:none"></canvas>

  <p>Records with name: <span id="totalCount"></span>

  	<p>This demo is based on real data from US Social Security applications between 1914 and 2014. Thank you to <a href="https://www.kaggle.com/kaggle/us-baby-names">https://www.kaggle.com/kaggle/us-baby-names</a> for compiling the data. <a href="../../../data/babyNames/count_map.json" download="countMap.json" class="btn btn-secondary btn-sm">Download Data</a>.</p>

<h3>Computation</h3>

<p> The US Social Security applications data provides you with a function: <code>count(year, name)</code> which returns the number of US citizens, born in a given year with a given name. You also have access to a list <code>names</code> which has each name ever given in the US and <code>years</code> which has all the years. This function is implicitly giving us the joint probability over names and birth year. The probability of a joint assignment to name and birth year can be estimated as the count of people with that name, born on that year, over the total number of people in the dataset. Let $B$ be the year someone is born, and let $N$ be their name:
	$$
	P(B = b,N = n) \approx 
	\frac{\text{count}(b, n)}
	{\sum\limits_{i \in \text{names}} \sum\limits_{j \in \text{years}} \text{count}(i,j)}
	$$

<p>The question we would really like to answer is: what  is  your belief  that  a  resident  was  born  in  1950,  given  that  their name is Gary?</p>

	We can get started by applying the definition of conditional probability for random variables:

		\begin{align*}
		\P( B = 1950 | N = \text{Gary} ) = \frac{\P(N = \text{Gary} , B = 1950)}{\P(N = \text{Gary})}
		\end{align*}
But this leaves one term to compute: $\P(N = \text{Gary})$ which we can compute using marginalization:

\begin{align*}
\P( N = \text{Gary}) &= \sum_{y \in \text{years}} P(B = y,N = \text{Gary})\\
&\approx \frac{  \sum\limits_{y \in \text{years}} \text{count}(y, \text{Gary})}{\sum\limits_{i \in \text{names}} \sum\limits_{j \in \text{years}} \text{count}(i,j)}
\end{align*}



<p>Putting this all together we have:

\begin{align*}
\P( B = 1950 | N = \text{Gary} ) 
&= \frac{\P(N = \text{Gary} , B = 1950)}{\P(N = \text{Gary})} \\
&\approx 
\frac
{
	\Big(
	\frac{\text{count}(1950, \text{Gary})}
	{\sum\limits_{i \in \text{names}} \sum\limits_{j \in \text{years}} \text{count}(i,j)}
	\Big)
}
{
	\Big(
	\frac{  \sum\limits_{y \in \text{years}} \text{count}(y, \text{Gary})}{\sum\limits_{i \in \text{names}} \sum\limits_{j \in \text{years}} \text{count}(i,j)}
	\Big)
} \\
&\approx
\frac
{
	\text{count}(1950, \text{Gary})
}
{
	\sum\limits_{y \in \text{years}} \text{count}(y, \text{Gary})
}
\end{align*}


<p>More generally, for any name, we can compute the conditional probability mass function over birth year $B$:

	\begin{align*}
\P( B = b | N = n ) 
&\approx 
\frac
{
	\text{count}(b, n)
}
{
	\sum\limits_{y \in \text{years}} \text{count}(y, n)
}
\end{align*}

<h3>From Birth Year to Age</h3>

<p>Of course, if $B$ is the birth year of a person, their age, $A$ is approximately the current year minus $B$. This could be off by one if someone has a birth day later in the year, but we will ignore this small deviation for now. So for example, if we think that a person was born in 1988, since the current year is <span class="currYear"></span> then their age is <span class="currYear"></span> - 1988 = <span id="exampleAge"></span></p>

<h3>Assumptions</h3>

<p>This problem makes many assumptions which are worth highlighting. In fact, any time we make generalizations (especially about demographics) based on sparse information we should tread lightly. Here are the assumptions that I can think of:

<ol>
	<!-- <li>We assume that people don't change their first names. Obviously this is wrong. It is especially wrong for the trans community, thus introducing a systematic error.</li>
	<li>This algorithm doesn't take into account the distribution over who could plaussibly be alive at the time the name was recorded. For example, lets say the name was recorded from a user in 2021. That user likely wasn't born in 1800.</li> -->
	<li>This data only is accurate for names of people in the US. The probability of age given names could be very different in other countries.</li>
	<li>The US census is not perfect. It does not capture all people who are resident in the US, and there are demographics which are underrepresented. This will also skew our results.</li>
</ol>


<h3>Names that Give Away Your Age</h3>

<p>Some names have certain years where they were exceptionally popular. These names provide quite a lot of information about birth year. Let's look at some of the names with the highest max probability.</p>

<p><b>Medium Popularity (>10,000 people with the name)</b><br/>
	<table class="table table-sm table-hover">
		<thead>
		<tr><th>Name</th><th>Age with max prob</th><th>Prob of most likely age</th></tr>
</thead>
<tr><td>Katina	</td><td class="yearsAt2021">49</td> 	<td>0.245</td></tr>
<tr><td>Marquita	</td><td class="yearsAt2021">38</td> 	<td>0.233</td></tr>
<tr><td>Ashanti	</td><td class="yearsAt2021">19</td> 	<td>0.250</td></tr>
<tr><td>Miley</td>	<td class="yearsAt2021">13</td> <td>0.250</td><td></td></tr>
<tr><td>Aria	</td><td class="yearsAt2021">7</td> 	<td>0.247</td></tr>


	</table>

	<p><b>High Popularity (>100,000 people with the name)</b><br/>
	<table class="table table-sm table-hover">
				<thead>
		<tr><th>Name</th><th>Age with max prob</th><th>Prob of most likely age</th></tr>
</thead>
<tr><td>Debbie	</td>	<td class="yearsAt2021">62</td>  <td>0.104</td></tr>
<tr><td>Whitney	</td>	<td class="yearsAt2021">35</td>  <td>0.098</td></tr>
<tr><td>Chelsea	</td>	<td class="yearsAt2021">29</td>  <td>0.103</td></tr>
<tr><td>Aidan	</td>	<td class="yearsAt2021">18</td>  <td>0.098</td></tr>
<tr><td>Addison</td>	<td class="yearsAt2021">14</td>  <td>0.112</td></tr>
	</table>

	<p>A search for "Katina 1972" brought up this interesting article about a baby named Katina in a 1972<a target="_blank" href="http://www.nancy.cc/2012/01/25/baby-name-katina/"> CBS Soap Opera</a>. Marquita's popularity was likely from a 1983 <a target="_blank" href="https://www.youtube.com/watch?v=K2LcWa4G0W4">toothpase add</a>. <a target="_blank" href="https://en.wikipedia.org/wiki/Ashanti_(singer)">Ashanti Douglas</a> and <a target="_blank" href="https://en.wikipedia.org/wiki/Miley_Cyrus">Miley Cirus</a> were popular singers in 2002 and 2008 respectively. 

<h3>Futher Reading</h3>
<p>Some names don't seem to have enough data to make good probability estimates. Can we quantify our uncertainty in such probability estimates? For example, if a name has only 10,000 entries in the database, of which only 100 were born in the year 1950, how confident are we that the true probability for 1950 is $\frac{100}{10000} = 0.01$? One way to express our uncertainty would be through a <a href="../../part4/beta">Beta Distribution</a>. In this scenario we could represent our belief in the probability for 1950 as $X \sim \Beta(a=101, b=9901)$ reflecting that we have seen 100 people born in 1950 and 9900 people who were not. We can plot that belief, zoomed into the range [0, 0.03]:

<canvas id="betaPdfnameBeta" style="max-height: 400px"></canvas>

<script>

$(document).ready(function(){
	drawBetaPdfnameBeta("betaPdfnameBeta", 101, 9901)
})


function drawBetaPdfnameBeta(parentDivId, a, b) {
	console.log(parentDivId)
	let min = 0
	let max = 0.03
	let N_BUCKETS = 100.0

	var xValues = []
	var yValues = []
	for (var i = 0; i < N_BUCKETS + 1; i++) {
		let t = i / N_BUCKETS
		let x = min + t * (max - min)
		let y = jStat.beta.pdf(x, a,b).toFixed(5)
		xValues.push(x)
		yValues.push(y)
	}

	let xLabel = 'Values that X can take on'
	let yLabel = 'Probability Density'

	var config = standardPDFConfig(xValues, yValues, xLabel, yLabel)
	config['options']['scales']['x'] = {
        max: max,
        min: min,
        type: 'linear',
        ticks: {
            precision: 5
        }
    }
	var ctx = document.getElementById(parentDivId).getContext('2d');
	new Chart(ctx, config);
}
</script>
<p>We can now ask questions such as, what is the probability that $X$ is within 0.002 of 0.01?</p>
\begin{align*}
P(&0.008 < X < 0.012) \\
&= P(X < 0.012) - P(X < 0.008) \\
&= F_X(0.012) - F_X(0.008) \\
&= 0.966 - 0.013 \\
&= 0.953
\end{align*}

<p>Semantically this leads to the claim that, after observing 100 births with a name in 1950, out of  10,000 births with that name over the whole dataset, there is a 95% chance that the probability of someone being born in 1950 is 0.010 $\pm$ 0.002.
<script>

var data = null

$.getJSON("../../../data/babyNames/count_map.json", function(json) {
    data = json;
    runName2Age()
});



$( document ).ready(function() {
    let year = getCurrYear()
    $(".currYear").html(year)
    let exampleAge = year - 1988
    $("#exampleAge").html(exampleAge)
});

function getCurrYear() {
	return new Date().getFullYear()
}

function runName2Age() {
	var queryName = $("#queryName").val();
	queryName = queryName.toLowerCase();
	console.log(queryName)
	let isValid = data[queryName] !== undefined
	if(isValid) {
		$("#queryName").removeClass("is-invalid")
		$("#queryName").addClass("is-valid")
		$("#dataLoader").hide()
		$("#babyNamePMF").show()
		plotName(queryName)
	} else {
		$("#queryName").removeClass("is-valid")
		$("#queryName").addClass("is-invalid")
		$("#totalCount").html("")
	}
}

function plotName(queryName) {
	if(window.name2AgeLine) {
		window.name2AgeLine.destroy()
	}
	let nameCounts = data[queryName]
	var xValues = []
	var yValues = []
	let currYear = getCurrYear()

	var total = 0
	for (const [year, count] of Object.entries(nameCounts)) {
	  total += count

	}
	console.log(total)
	$("#totalCount").html(total)
	
	for (const [year, count] of Object.entries(nameCounts)) {
	  let age = currYear - year
	  xValues.unshift(age)
	  let pr = count / total
	  yValues.unshift(pr)
	}

	var config = standardPDFConfig(xValues, yValues, 'Age', 'Probability')
	config['data']['datasets'][0]['label'] = 'P(age)'
	var ctx = document.getElementById("babyNamePMF").getContext('2d');
	window.name2AgeLine = new Chart(ctx, config);
}
</script>


                        



<script type="text/javascript">
    // const firebase = require("firebase");
    // Required for side-effects
    // require("firebase/firestore");

    $(document).ready(function () {
        console.log('ready')
        const scrollTop = getScrollTop()
        console.log(scrollTop)
        $("#sidebar").scrollTop(scrollTop)
        $("#sidebar").scroll(function() {
          localStorage.scrollTop = $("#sidebar").scrollTop()
        })
        // $("#sidebar").mCustomScrollbar({
        //     theme: "minimal",
        //     mouseWheel: {preventDefault: true},
        //     advanced:{
        //      autoScrollOnFocus: false,
        //      updateOnContentResize: true
        //     },
        //     scrollInertia:0,
        //     contentTouchScroll:1,
        //     mouseWheel: {
        //         scrollAmount:1000
        //     },
        //     setTop:scrollTop + 'px',
        //     callbacks:{
        //         onScroll:function(){
        //             if(hasStorage) {

        //                 localStorage.scrollTop = this.mcs.top;
        //                 console.log(localStorage.scrollTop)
        //             }
        //         }
        //     } 
        // });

        $('#sidebarCollapse').on('click', function () {
            $('#sidebar, #content').toggleClass('active');
            $('.collapse.in').toggleClass('in');
            $('a[aria-expanded=true]').attr('aria-expanded', 'false');
        });

        
        let lastPart = getUrlKey()
        
        // Bug: this code will highlight anything which matches with the last part
        $("#sidebar").find('a').each(function(){
            // find link which ends with last part and add style
            let currLink = $($(this)[0]).attr('href')
            let currLastPart = getLastPartOfUrl(currLink)
            if (currLastPart === lastPart) {
                $($(this)[0]).addClass('active-link');
            }
        })
    });

    function getScrollTop() {
        if(typeof(Storage) !== "undefined") {
            return Number(localStorage.scrollTop)
        }
        return 0;
    }

    function getUrlKey() {
        var path = window.location.pathname;
        return getLastPartOfUrl(path)
        
    }

    function getLastPartOfUrl(path) {
        let parts = path.split('/')
        var currIndex = parts.length - 1
        while(currIndex >= 0) {
            let nextPart = parts[currIndex]
            if(nextPart) {
                return nextPart
            }
            currIndex -= 1
        }
        return ''
    }

    function submitQuestion() {
        firebase.initializeApp({
          apiKey: "AIzaSyBqZVV7Qrp0DT3aBCCTCTMUCrPJO0pb3tY",
          authDomain: "probability-digital-world.firebaseapp.com",
          projectId: "probability-digital-world"
        });

        var db = firebase.firestore();

        db.collection("questions").add({
            email: $("#question-email").val(),
            question: "Lovelace",
            page: getUrlKey()
        })
        .then(function(docRef) {
            console.log("Document written with ID: ", docRef.id);
            alert('success')
        })
        .catch(function(error) {
            console.error("Error adding document: ", error);
        });
        // // // Generate a new push ID for the new post
        // var questionListRef = db.child("questions")
        // var newQuestionRef = questionListRef.push();
        // newQuestionRef.set({
        //     'title':'test'
        // });
        
    }

    function onCuriosity() {
        Swal.fire({
          title: 'Curious?',
          position: 'bottom-end',
          allowOutsideClick:false,
          backdrop:false,
          confirmButtonText: 'Submit',
          input: 'textarea',
          html:
            '<p>We are trying to make this book better. Let us know if you find something confusing. If you ask a question we will try to answer it. If you find a mistake we will fix it. </p>' +
            '<input placeholder="Your email (optional)..." id="question-email" class="swal2-input">',
          inputPlaceholder: 'Type your question or message here...',
          inputAttributes: {
            'aria-label': 'Type your question or message here'
          },
          showCancelButton: true,
          preConfirm: () => submitQuestion()
        })
    }
</script>
                
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>

$(document).ready(function() {
  //addH2Numbers()
  enableSearch()
})

function addH2Numbers() {
  $("h2").each(function(i){
    let title = $(this).html()
    title = `${i+1}. ${title}`
    $(this).html(title)
  })
}

function enableSearch() {
  $("#probability-for-digital-world-search").on('keyup', function (e) {
      if (e.key === 'Enter' || e.keyCode === 13) {
          let query = $("#probability-for-digital-world-search").val()
          
          window.location = `../../search.html?q=${query}`
      }
  });
  // $.ajax({
  //     type: "GET",
  //     url: "../../../searchIndex.json",
  //     dataType: "text",
  //     success: function(data) {addSearchIndexData(data);}
  //  });
}

function standardPMFConfig(xValues, yValues, xLabel, yLabel){
  return {
    type: 'bar',
    data: {
      labels: xValues,
      datasets: [{
        label: 'P(x)',
        fill: false,
        backgroundColor: 'blue',
        borderColor: 'blue',
        data: yValues,
        pointRadius:1,
        maxBarThickness:100,
        pointHitRadius: 20
      }]
    },
    options: {

      steppedLine: false,
      responsive: true,
      tooltips: {
        mode: 'index',
        intersect: false,
      },
      hover: {
        mode: 'nearest',
        intersect: true
      },
      animation: {
            duration: 0
        },
      plugins: {
        legend: {
              display: false
           },
         },
      scales: {
        x: {
          display: true,
          type: 'linear',
          title: {
            display: true,
            text: xLabel
          }
        },
        y: {
          display: true,
          title: {
            display: true,
            text: yLabel
          },
          ticks: {
            beginAtZero: true
          }
        }
      }
    }
  };
}

function standardPDFConfig(xValues, yValues, xLabel, yLabel){
  return {
    type: 'line',
    data: {
      labels: xValues,
      datasets: [{
        label: 'f(x)',
        fill: false,
        backgroundColor: 'blue',
        borderColor: 'blue',
        data: yValues,
        pointRadius:1,
        maxBarThickness:100,
        pointHitRadius: 20
      }]
    },
    options: {
      steppedLine: false,
      responsive: true,
      tooltips: {
        mode: 'index',
        intersect: false,
      },
      hover: {
        mode: 'nearest',
        intersect: true
      },
      animation: {
            duration: 0
        },
      plugins: {
        legend: {
              display: false
           },
         },
      scales: {
        x: {
          display: true,
          type: 'linear',
          title: {
            display: true,
            text: xLabel
          }
        },
        y: {
          display: true,
          title: {
            display: true,
            text: yLabel
          },
          ticks: {
            beginAtZero: true
          }
        }
      }
    }
  };
}

function standardPDFsConfig(datasets, xValues, xLabel, yLabel){
  return {
    type: 'line',
    data: {
      datasets: datasets
    },
    options: {

      steppedLine: false,
      responsive: true,
      tooltips: {
        mode: 'index',
        intersect: false,
      },
      hover: {
        mode: 'nearest',
        intersect: true
      },
      animation: {
            duration: 0
        },
      plugins: {
        legend: {
              display: false
           },
         },
      scales: {
        x: {
          display: true,
          type: 'linear',
          title: {
            display: true,
            text: xLabel
          }
        },
        y: {
          display: true,
          title: {
            display: true,
            text: yLabel
          },
          ticks: {
            beginAtZero: true
          }
        }
      }
    }
  };
}


function addSearchIndexData(data) {
  var idx = lunr(function () {
    this.ref('name')
    this.field('text')

    let documents = JSON.parse(data)

    documents.forEach(function (doc) {
      this.add(doc)
    }, this)

    $("#probability-for-digital-world-search").on('keyup', function (e) {
        if (e.key === 'Enter' || e.keyCode === 13) {
            let query = $("#probability-for-digital-world-search").val()
            let results = idx.search(query)
        }
    });
  })
}

    </script>

</body>




</html>