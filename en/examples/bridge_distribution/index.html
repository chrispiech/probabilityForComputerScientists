
<!DOCTYPE html>
<html>

<head>
    

<title>Bridge Card Game</title>

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta http-equiv="content-type" content="text/html; charset=UTF8">

<link rel="shortcut icon" type="image/x-icon" href="../../../favicon.ico">

<!-- Python highlighting -->
<script src="../../../plugins/prism/prism.js"></script>
<link href="../../../plugins/prism/prism.css" rel="stylesheet" />

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" integrity="sha512-uto9mlQzrs59VwILcLiRYeLKPPbS/bT71da/OEBYEwcdNUk8jYIy+D176RYoop1Da+f9mvkYrmj5MCLZWEtQuA==" crossorigin="anonymous"></script>
 <link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.css" rel="Stylesheet" type="text/css" />

<!-- D3 CDN -->
<script src="https://d3js.org/d3.v3.js"></script>
<!-- <script src="https://d3js.org/d3.v4.js"></script> -->
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

<!-- Chart CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.6.0/dist/chart.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/1.0.2/chartjs-plugin-annotation.min.js" integrity="sha512-FuXN8O36qmtA+vRJyRoAxPcThh/1KJJp7WSRnjCpqA+13HYGrSWiyzrCHalCWi42L5qH1jt88lX5wy5JyFxhfQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<!-- PDF JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.min.js" integrity="sha512-Z8CqofpIcnJN80feS2uccz+pXWgZzeKxDsDNMD/dJ6997/LSRY+W4NmEt9acwR+Gt9OHN0kkI1CTianCwoqcjQ==" crossorigin="anonymous"></script>

<!-- Lunr CDN -->
 <script src="https://unpkg.com/lunr@2.0.4/lunr.js"></script>

<!-- Firebase CDN -->
<script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="../../../css/style.css">

<!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-app.js"></script>

  <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
  <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-analytics.js"></script>

  <!-- Add Firebase products that you want to use -->
  <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-firestore.js"></script>


   

<!-- Java Script -->
<script src="../../../plugins/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<!-- Python highlighting -->
<script src="../../../plugins/prism/prism.js"></script>
<link href="../../../plugins/prism/prism.css" rel="stylesheet" />

<!-- Probability Packages -->
<script src="../../../js/probabilityUtils.js"></script>
<script src="../../../plugins/probability/gaussian.js"></script>
<script src="../../../plugins/color.js"></script>
<script src='https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js'></script>


<!-- font awesome -->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">

<!-- SWAL -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>


<!-- Stanford -->
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Source+Serif+Pro:400,600,700' rel='stylesheet' type='text/css'>
<link href="https://fonts.googleapis.com/css?family=Crimson+Text" rel="stylesheet">

<!-- Math Jax -->
<!-- <script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script> -->
<script type="text/javascript">
  MathJax = {
    config: ["MMLorHTML.js"],
    jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML"],
    extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js"],
    TeX: {
      extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js", "action.js"]
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    },
	"fast-preview": {
	  disabled: true
	}
  };
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>



<script src="../../../plugins/math.min.js"></script>



    <!-- Popper.JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

 <!-- Scrollbar Custom CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.min.css">
    <script src="../../../plugins/jquery.mCustomScrollbar.js"></script>

</head>

<script>
  Chart.defaults.font.family = 'Times New Roman';
  Chart.defaults.font.size = 18;
</script>


<!-- I declare a few math operators I often use in equations -->
<div style="display:none">
  $\DeclareMathOperator{\p}{P}$
  $\DeclareMathOperator{\P}{P}$
  $\DeclareMathOperator{\c}{^C}$
  $\DeclareMathOperator{\or}{  or}$
  $\DeclareMathOperator{\and}{  and}$
  $\DeclareMathOperator{\var}{Var}$
  $\DeclareMathOperator{\Var}{Var}$
  $\DeclareMathOperator{\Std}{Std}$
  $\DeclareMathOperator{\E}{E}$
  $\DeclareMathOperator{\std}{Std}$
  $\DeclareMathOperator{\Ber}{Bern}$
  $\DeclareMathOperator{\Bin}{Bin}$
  $\DeclareMathOperator{\Poi}{Poi}$
  $\DeclareMathOperator{\Uni}{Uni}$
  $\DeclareMathOperator{\Geo}{Geo}$
  $\DeclareMathOperator{\NegBin}{NegBin}$
  $\DeclareMathOperator{\Beta}{Beta}$
  $\DeclareMathOperator{\Exp}{Exp}$
  $\DeclareMathOperator{\N}{N}$
  $\DeclareMathOperator{\R}{\mathbb{R}}$
  $\DeclareMathOperator*{\argmax}{arg\,max}$
  $\newcommand{\d}{\, d}$
  
</div>

<body class="greyBackground">


    <div class="wrapper">
        <!-- Sidebar  -->
<nav id="sidebar">
    <div class="sidebar-header">
        <!-- <div></div> -->
        <a style="text-align:left" href="../../index.html"><h3></i> Probability<br/>For Computer Science<br/></h3></a>
    </div>

    <div> 
        <!-- Put a link back to cs109 -->
    

        <!-- This adds a search bar! -->
        <div class="searchCol" style="font-family: 'Source Sans Pro', sans-serif;">
            
            <input type="text" class="form-control bookSearch" id="probability-for-digital-world-search" aria-describedby="search box" placeholder="🔍 Search book..."/>
        </div>
        
    </div>

<!-- intro -->
<ul class="list-unstyled components">
<li>
<a id=sidebar-notation href="../../intro/notation">Notation Reference</a>
<a id=sidebar-core_probability_ref href="../../intro/core_probability_ref">Core Probability Reference</a>
<a id=sidebar-all_distributions href="../../intro/all_distributions">Random Variable Reference</a>
<a id=sidebar-python href="../../intro/python">Python Reference</a>
<a id=sidebar-calculators href="../../intro/calculators">Calculators</a>
</li>
</ul>

<!-- part1 -->
<ul class="list-unstyled components">
<li><p href="{pathToLang}part1">Part 1: Core Probability</p></li>
<li>
<a id=sidebar-counting href="../../part1/counting">Counting</a>
<a id=sidebar-combinatorics href="../../part1/combinatorics">Combinatorics</a>
<a id=sidebar-probability href="../../part1/probability">Definition of Probability</a>
<a id=sidebar-equally_likely href="../../part1/equally_likely">Equally Likely Outcomes</a>
<a id=sidebar-prob_or href="../../part1/prob_or">Probability of <b>or</b></a>
<a id=sidebar-cond_prob href="../../part1/cond_prob">Conditional Probability</a>
<a id=sidebar-independence href="../../part1/independence">Independence</a>
<a id=sidebar-prob_and href="../../part1/prob_and">Probability of <b>and</b></a>
<a id=sidebar-law_total href="../../part1/law_total">Law of Total Probability</a>
<a id=sidebar-bayes_theorem href="../../part1/bayes_theorem">Bayes' Theorem</a>
<a id=sidebar-log_probabilities href="../../part1/log_probabilities">Log Probabilities</a>
<a id=sidebar-many_flips href="../../part1/many_flips">Many Coin Flips</a>

<li>
    <a href="#part1_examples" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle show">Applications</a>
    <ul class="collapse list-unstyled show" id="part1_examples">
        <li><a href="../../examples/enigma">Enigma Machine</a></li><li><a href="../../examples/serendipity">Serendipity</a></li><li><a href="../../examples/random_shuffles">Random Shuffles</a></li><li><a href="../../examples/counting_graphs">Random Graphs</a></li><li><a href="../../examples/diversity_shapes">Set Diversity</a></li><li><a href="../../examples/bacteria_evolution">Bacteria Evolution</a></li>
    </ul>
</li>
</li>
</ul>

<!-- part2 -->
<ul class="list-unstyled components">
<li><p href="{pathToLang}part2">Part 2: Random Variables</p></li>
<li>
<a id=sidebar-rvs href="../../part2/rvs">Random Variables</a>
<a id=sidebar-pmf href="../../part2/pmf">Probability Mass Functions</a>
<a id=sidebar-expectation href="../../part2/expectation">Expectation</a>
<a id=sidebar-variance href="../../part2/variance">Variance</a>
<a id=sidebar-bernoulli href="../../part2/bernoulli">Bernoulli Distribution</a>
<a id=sidebar-binomial href="../../part2/binomial">Binomial Distribution</a>
<a id=sidebar-poisson href="../../part2/poisson">Poisson Distribution</a>
<a id=sidebar-more_discrete href="../../part2/more_discrete">More Discrete Distributions</a>
<a id=sidebar-categorical href="../../part2/categorical">Categorical Distributions</a>
<a id=sidebar-continuous href="../../part2/continuous">Continuous Distribution</a>
<a id=sidebar-uniform href="../../part2/uniform">Uniform Distribution</a>
<a id=sidebar-exponential href="../../part2/exponential">Exponential Distribution</a>
<a id=sidebar-normal href="../../part2/normal">Normal Distribution</a>
<a id=sidebar-binomial_approx href="../../part2/binomial_approx">Binomial Approximation</a>

<li>
    <a href="#part2_examples" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle show">Applications</a>
    <ul class="collapse list-unstyled show" id="part2_examples">
        <li><a href="../../examples/100_binomial_problems">100 Binomial Problems</a></li><li><a href="../../examples/winning_series">Winning Series</a></li><li><a href="../../examples/approximate_counting">Approximate Counting</a></li><li><a href="../../examples/jury">Jury Selection</a></li><li><a href="../../examples/grading_eye_inflammation">Grading Eye Inflamation</a></li><li><a href="../../examples/grades_not_normal">Grades are Not Normal</a></li><li><a href="../../examples/curse_of_dimensionality">Curse of Dimensionality</a></li><li><a href="../../examples/algorithmic_art">Algorithmic Art</a></li>
    </ul>
</li>
</li>
</ul>

<!-- part3 -->
<ul class="list-unstyled components">
<li><p href="{pathToLang}part3">Part 3: Probabilistic Models</p></li>
<li>
<a id=sidebar-joint href="../../part3/joint">Joint Probability</a>
<a id=sidebar-marginalization href="../../part3/marginalization">Marginalization</a>
<a id=sidebar-multinomial href="../../part3/multinomial">Multinomial</a>
<a id=sidebar-continuous_joint href="../../part3/continuous_joint">Continuous Joint</a>
<a id=sidebar-inference href="../../part3/inference">Inference</a>
<a id=sidebar-bayesian_networks href="../../part3/bayesian_networks">Bayesian Networks</a>
<a id=sidebar-independent_vars href="../../part3/independent_vars">Independence in Variables</a>
<a id=sidebar-correlation href="../../part3/correlation">Correlation</a>
<a id=sidebar-computational_inference href="../../part3/computational_inference">General Inference</a>

<li>
    <a href="#part3_examples" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle show">Applications</a>
    <ul class="collapse list-unstyled show" id="part3_examples">
        <li><a href="../../examples/fairness">Fairness in AI</a></li><li><a href="../../examples/federalist">Federalist Paper Authorship</a></li><li><a href="../../examples/name2age">Name to Age</a></li><li><a href="../../examples/prob_baby_delivery">Probability of Baby Delivery</a></li><li><a href="../../examples/bayesian_carbon_dating">Bayesian Carbon Dating</a></li><li><a href="../../examples/digital_vision_test">Digital Vision Test</a></li><li><a href="../../examples/bridge_distribution">Bridge Distribution</a></li><li><a href="../../examples/bayesian_viral_load_test">Bayesian Viral Load Test</a></li><li><a href="../../examples/dart_logo">CS109 Logo</a></li><li><a href="../../examples/tracking_in_2D">Tracking in 2D</a></li>
    </ul>
</li>
</li>
</ul>

<!-- part4 -->
<ul class="list-unstyled components">
<li><p href="{pathToLang}part4">Part 4: Uncertainty Theory</p></li>
<li>
<a id=sidebar-beta href="../../part4/beta">Beta Distribution</a>
<a id=sidebar-summation_vars href="../../part4/summation_vars">Adding Random Variables</a>
<a id=sidebar-clt href="../../part4/clt">Central Limit Theorem</a>
<a id=sidebar-samples href="../../part4/samples">Sampling</a>
<a id=sidebar-bootstrapping href="../../part4/bootstrapping">Bootstrapping</a>
<a id=sidebar-algorithmic_analysis href="../../part4/algorithmic_analysis">Algorithmic Analysis</a>
<a id=sidebar-information_theory href="../../part4/information_theory">Information Theory</a>

<li>
    <a href="#part4_examples" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle show">Applications</a>
    <ul class="collapse list-unstyled show" id="part4_examples">
        <li><a href="../../examples/thompson">Thompson Sampling</a></li><li><a href="../../examples/night_sight">Night Sight</a></li><li><a href="../../examples/p_hacking">P-Hacking</a></li><li><a href="../../examples/differential_privacy">Differential Privacy</a></li>
    </ul>
</li>
</li>
</ul>

<!-- part5 -->
<ul class="list-unstyled components">
<li><p href="{pathToLang}part5">Part 5: Machine Learning</p></li>
<li>
<a id=sidebar-parameter_estimation href="../../part5/parameter_estimation">Parameter Estimation</a>
<a id=sidebar-mle href="../../part5/mle">Maximum Likelihood Estimation</a>
<a id=sidebar-map href="../../part5/map">Maximum A Posteriori</a>
<a id=sidebar-machine_learning href="../../part5/machine_learning">Machine Learning</a>
<a id=sidebar-naive_bayes href="../../part5/naive_bayes">Naïve Bayes</a>
<a id=sidebar-log_regression href="../../part5/log_regression">Logistic Regression</a>

<li>
    <a href="#part5_examples" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle show">Applications</a>
    <ul class="collapse list-unstyled show" id="part5_examples">
        <li><a href="../../examples/mle_demo">MLE Normal Demo</a></li><li><a href="../../examples/mle_pareto">MLE Pareto Distribution</a></li><li><a href="../../examples/mixture_models">MLE Mixture Model</a></li>
    </ul>
</li>
</li>
</ul>



    <!-- <ul class="list-unstyled components">
        
         <li>
            <p>Part ?: Misfits</p>
        </li>
        <li>
             <a href="../../examples/probBabies.html">Probability and babies</a>
            
             <a href="../../">Sampling from a likelihood function</a>
             <a href="../../">Law of Total Expectation</a>
            
        </li>
    </ul> -->



    <ul class="list-unstyled CTAs">
        <li>
            Ⓒ Chris Piech, Stanford University
            <!-- <a href="https://compedu.stanford.edu/codeinplace/v1/#/course" class="download">Back to Code in Place</a> -->
        </li>
    </ul>
</nav>
        <!-- Page Content  -->
        <div id="content">

<button type="button" id="sidebarCollapse" class="mobile-only btn btn-dark exclude-from-print">
    <i class="fas fa-align-left"></i>
    <span></span>
</button>
            <!-- <button id="curiosityButton" onclick = "onCuriosity()" type="button" class="btn btn-primary btn-sm">
              <span style="font-size:150%">I'm Curious</span>
              <span></span>
          </button> -->
            
            <div class="container-fluid">
                <div class="row d-flex justify-content-center">
                    <div class="col handout" >
              
                        
 
<center><h1>Bridge Card Game</h1></center>
<hr/>

<p>
	<div>

		
		<p> <a href="https://en.wikipedia.org/wiki/Contract_bridge">Bridge</a> is one of the most popular collaborative card games. It is played with four players in two teams. A few interesting probability problems come up in this game. You do not need to know the rules of bridge to follow this example. I focus on a set of probability problems which are most important for game strategy.

		

<p>
	<div class="">
		<h3>Distribution of Hand Strength</h3>

		<p>The way folks play bridge is that they make a calculation about their "hand strength" and then make decisions based off that number. The strength of your hand is a number which is equal to 4 times the number of "aces", 3 times the number of "kings", 2 times the number of "queens" and 1 times the number of "jacks" in your hand. No other cards contribute to your hand strength. Lets consider your hand strength to be a random variable and compute its distribution. It seems complex to compute by hand -- but perhaps we could run a simulation? Here we simulate a million deals of bridge hands and calculate the hand strengths. Let $X$ be the strength of a hand. From the <a target="_blank" href="../../part1/probability/">Definition of Probability</a>:
			$$
			\p(X=x) \approx \frac{\text{count}(x)}{100000}
			$$
<canvas id="bridgePoints" style="max-height: 500px"></canvas>

<!-- <p>Here is the pseudo code used to simulate</p>
<pre class="language-python"><code></code></pre> -->

<p><div class="purpleBox"><b>Wait! Is that a Poisson?</b><br/>
	
	<p>If you pay very close attention might notice that this PMF looks a lot like a poisson PMF with rate $\lambda = 10$. There is a nice explanation for why the rate might be 10. Let $H$ be the value of your hand. Let $X_i$ be the points of the $i$th card in your hand, which has 13 cards. $H = \sum_{i=1}^{13} X_i$.</p>
	
	First we compute $\E[X_i]$, the expectation of points for the $i$th card in your hand &mdash; without considering the other cards . A card can take on four non zero values $X_i \in \{1, 2, 3, 4\}$. For each value there are four cards out of 52 with that value, eg  $\p(X_i=1) = \frac{4}{52}$. Thus 
	
	\begin{align*}
	\E[X_i] &= \sum_x x \cdot \p(X_i=x) \\
	&= (1+2+3+4)\frac{1}{13} \\
	&= \frac{10}{13}  
	\end{align*}

We can then calculate $\E[H]$ by using the fact that the expectation of the sum of random variables is the sum of expectations, regardless of independence:	
	\begin{align}\E[H] 
	&= \sum_{i=1}^{13} \E[X_i] \\
	&= 13 \cdot \E[X_i] \\
	&= 13 \cdot \frac{10}{13} \\
	&= 10\end{align}
Saying that $H$ is approximately $\sim \Poi(\lambda=10)$ is an interesting claim. It suggests that points in a hand come at a constant rate, and that the next point in your hand is independent of when you got your last point. Of course this second part of the assumption is mildly violated. There are a fixed set of cards so getting one card changes the probabilities of others. For this reason the poisson is a close, but not perfect approximation.</div>

<h3>Joint Distribution of Hand Strength Among Two Hands</h3>
<p>It doesn't just matter how strong your hand is, but the relative strength of your hand and your partners hand (recall that in Bridge you play with a partner). We know that the two hands are not independent of each other. If I tell you that your partner has a strong hand, that means there are fewer "high value" cards that can be in your hand, and as such my belief in your strength has changed.  If you think about each player's hand strength as a random variable, we care about the joint distribution of hand strength. In the joint distribution bellow the x-axis is your partner's hand strength and on the y-axis is your hand strength. The value is $\p(\text{Partner} = x, \text{YourPoints} = y)$. This joint distribution was calculated by simulating a million randomly dealt hands:
<p>
	<div style=""id="my_dataviz"></div>
</p>

<p>From this joint distribution we can compute conditional probabilities. For example we can compute the conditional distribution of your partner's points given your points using lookups from the joint:
\begin{align*}
\p(&\text{Partner} = x | \text{YourPoints} = y) \\
&= \frac
{ \p(\text{Partner} = x, \text{YourPoints} = y) }
{\p(\text{YourPoints} = y)} 
&& \text{Cond. Prob.}
\\
&= \frac
{ \p(\text{Partner} = x, \text{YourPoints} = y) }
{\sum_z \p(\text{Partner} = z, \text{YourPoints} = y)} 
&& \href{ ../../part1/law_total/}{\text{LOTP} }
\end{align*}
</p>

<p>Here is a working demo of the result</p>

<p>Your points: <input onchange="redrawCondGraph()" type="number" class="form-control example-inline-input mb-3" id="yourPoints" min="0" max="26" value="13" step = "1">
<canvas id="partnerPoints" style="max-height: 500px"></canvas>

	</div>
</p>

<h3>Distribution of Suit Splits</h3>



<p>
	When playing the game there are many times when one player will know <i>exactly</i> how many cards there are of a certain suit between  their two opponents hands (call the opponents A and B). However, the player won't know the "split": how many of that particular suit are in opponent A's hand and how many cards of that suit are in opponent B's hand.</p>

	<p>Both opponents have equal sized <a href="https://en.wikipedia.org/wiki/Glossary_of_card_game_terms">hands</a> with $k$ cards left. Across the two hands there are a known number of cards of a particular suit (eg spades) $n$, and you want to know how many are in one hand and how many are in the other. A split is represented as a tuple. For example $(0, 5)$ would mean 0 cards of the suit in opponent A's hands and 5 in opponent B's. Feel free to chose specific values for $k$ and $n$:
</p>

<p>

$k$, the number of cards in each player's hand: <input onchange="redrawGraph()" type="number" class="form-control example-inline-input mb-1" id="k" min="0" max="26" value="13" step = "1">

<br/>

$n$, the number of cards of particular suit among the two hands: <input onchange="redrawGraph()" type="number" class="form-control example-inline-input" id="n" min="0" max="13" value="5" step = "1">
</p>
<p>A few notes: If there are $k$ cards in each of the 2 hands there are $2 k$ cards total bewteen the two players. At the start of a game of bridge $k=13$. It must be the case that $n \leq 2  k$ because you can't have more cards of the suit left than number of cards! If there are $n$ of a suit, then there are $2k -n$ of other suits. This problem assumes that the cards are properly shuffled.

</p>

<b>Probability of different splits of the suit:</b>

	<p>Let $Y$ be a random variable representing the number of the suit in opponent A's hand. We can calculate the probability that $Y$ equals different values $i$ by counting equally likely outcomes.
$$\p(Y = i) = \frac
	{ {n \choose i} \cdot {2\cdot k-n \choose k-i} }
	{ {2\cdot k \choose k}}$$
	<p>Each outcome in the sample set is a chosen set of $k$ distinct cards  to be dealt to one player (out of the $2k$ cards). To create an outcome in the event space we first chose the $i$ cards from the $n$ cards of the given suit. We then chose $k-i$ from the cards of other suits. For $k = $<span class="valueK">13</span> and $n = $<span class="valueN">5</span> here is the PMF over splits:</p>
<canvas id="bridgeGraphEqual" style="max-height: 500px"></canvas>

<p>
	If we want to think about the probability of a given split, it is sufficient to chose one hand (call it "hand one"). If I tell you how many of a suit are in one hand, you can automatically figure out how many of the suit are in the other hand: recall that the number of the suit sums to $n$. 
	</p>


<div style="height:20px"></div>

<b>Probability that either hand has at least $j$ cards of suit</b>
<p>Let $X$ be a random variable representing the highest number of cards of the suit in <i>either</i> hand. We can calculate the probability by using probability of or.
$$\p(X \geq j) = 1 - \sum_{i=n-j+1}^{j - 1}\p(Y= i)$$
<canvas id="bridgeGraphOver" style="max-height: 500px"></canvas>
</div>
</p>

<script>

let charts = {}

$(document).ready(function() {
	redrawGraph()
	drawPointsDistribution()
	drawJointPoints()
})

function redrawCondGraph() {
	let yourPoints = parseInt($("#yourPoints").val())

	let partnerDist = []
	let original = BRIDGE_JOINT[yourPoints]
	for (var i = 0; i < original.length; i++) {
		partnerDist.push(original[i])
	}
	normalize([partnerDist])

	let dataCond = []
	for(let i = 0; i < partnerDist.length; i++) {
		let pr = partnerDist[i]
		dataCond.push([i, pr.toFixed(5)])
	}
	drawGraph(charts, 'partnerPoints', dataCond, 'x', `P(Partner = x | YourPoints = ${yourPoints})`)

}

function redrawGraph() {
	let n = parseInt($("#n").val())
	let k = parseInt($("#k").val()) * 2

	let dataEqual = []
	for(let j = 0; j <= n; j++) {
		let prEqual = calcPrEqual(k, n, j)
		let x = `(${j}, ${n-j})`
		dataEqual.push([x, prEqual.toFixed(3)])
	}
	drawGraph(charts, 'bridgeGraphEqual', dataEqual, 'Split (i, n-i)', 'Pr(Y = i)')

	let dataOver = []
	for(let j = 0; j <= n; j++) {
		let prOverJ = calcPrOverJ(k, n, j)
		dataOver.push([j, prOverJ.toFixed(3)])
	}
	drawGraph(charts, 'bridgeGraphOver', dataOver, 'Values of j', 'Pr(X ≥ j)')
}

function calcPrOverJ(k, n, j) {
	let pr = 1;
	let gapMin = (n - j) + 1
	let gapMax = j - 1
	for (var i = gapMin; i <= gapMax; i++) {
		pr -= calcPrEqual(k, n, i)
	}

	return pr
}

function calcPrEqual(k, n, i) {


	let denom = jStat.combination(k,k/2)
	let t1 = jStat.combination(n, i)
	let t2 = 0
	if(k/2 - i <= k -n ) {
		t2 = jStat.combination(k - n, k/2-i)
	}
	return t1 * t2 / denom
}

function drawJointPoints() {
	let pointsData = BRIDGE_JOINT
	normalize(pointsData)
	drawGrid(charts, 'my_dataviz', pointsData)
	redrawCondGraph()
}

function drawPointsDistribution() {
	let pointsData = [
		[0,0.003629],
		[1,0.00786275],
		[2,0.01351425],
		[3,0.024557],
		[4,0.03853875],
		[5,0.05182025],
		[6,0.0658735],
		[7,0.080111],
		[8,0.08886475],
		[9,0.093599],
		[10,0.0940935],
		[11,0.0895525],
		[12,0.08019275],
		[13,0.068997],
		[14,0.05687775],
		[15,0.044275],
		[16,0.03302275],
		[17,0.0237395],
		[18,0.01612125],
		[19,0.01031075],
		[20,0.00642275],
		[21,0.0037975],
		[22,0.0020915],
		[23,0.0011035],
		[24,0.0005705],
		[25,0.0002675],
		[26,0.0001195],
		[27,0.00004425],
		[28,0.0000195],
		[29,0.00000775],
		[30,0.0000015]
	]
	drawGraph(charts, 'bridgePoints', pointsData, 'x points in your hand', 'Pr(X=x)')
}

BRIDGE_JOINT = [[4,36,83,187,295,561,956,1372,2014,2548,3122,3640,3880,4044,4042,3610,3119,2837,2112,1658,1214,811,529,315,208,118,50,38,15,5,2],
[36,96,223,463,974,1549,2455,3557,4786,5815,7065,7919,8526,8760,8334,7592,6587,5573,4334,3257,2464,1567,1029,646,352,202,110,39,22,10,3],
[83,223,480,1036,1970,3157,4922,6813,8869,11134,12687,14216,14888,14876,13976,12553,11041,8879,6840,5154,3677,2441,1437,910,541,277,181,71,30,10,6],
[187,463,1036,2238,4172,6499,9700,13568,17255,21259,24614,26642,27036,26554,24772,21865,18403,14792,11079,8307,5660,3769,2300,1320,783,375,188,86,30,14,7],
[295,974,1970,4172,7484,11402,16962,23385,29576,35056,39710,42755,43233,40967,38116,32856,26954,21252,15810,11069,7596,4873,2911,1639,918,415,223,84,34,8,5],
[561,1549,3157,6499,11402,17408,24889,34801,42558,49760,55272,58287,57536,54546,48902,41380,33486,26005,18475,13074,8609,5428,3059,1777,888,429,216,82,34,7,2],
[956,2455,4922,9700,16962,24889,35190,47501,57819,65760,72304,74626,72622,67671,60052,49119,39006,29384,20966,14286,9137,5542,3137,1665,866,397,192,73,29,7,3],
[1372,3557,6813,13568,23385,34801,47501,62946,75202,85028,91182,92602,88417,80169,69357,55949,43842,31957,22130,14839,9293,5339,2840,1567,706,310,147,47,17,7,0],
[2014,4786,8869,17255,29576,42558,57819,75202,88946,97770,102889,102988,96137,85596,72411,57169,43796,31017,20891,13594,8288,4604,2458,1256,564,250,99,31,12,2,2],
[2548,5815,11134,21259,35056,49760,65760,85028,97770,106126,109734,107457,98910,85362,70878,55042,40580,28427,18496,11543,6781,3818,1838,923,437,156,67,16,5,2,0],
[3122,7065,12687,24614,39710,55272,72304,91182,102889,109734,110988,106614,95617,80768,65595,49582,36154,24555,15583,9358,5319,2758,1382,606,259,78,25,10,0,0,0],
[3640,7919,14216,26642,42755,58287,74626,92602,102988,107457,106614,100378,87800,73056,57425,42358,29423,19626,11964,6976,3899,1962,844,365,144,50,14,6,0,0,0],
[3880,8526,14888,27036,43233,57536,72622,88417,96137,98910,95617,87800,74848,60663,46687,33511,22835,14573,8593,4785,2597,1209,509,201,66,28,7,1,0,0,0],
[4044,8760,14876,26554,40967,54546,67671,80169,85596,85362,80768,73056,60663,48298,36195,25055,16486,10038,5677,3138,1530,673,278,74,39,10,2,1,0,0,0],
[4042,8334,13976,24772,38116,48902,60052,69357,72411,70878,65595,57425,46687,36195,26012,17508,11135,6684,3596,1842,839,350,134,48,13,3,0,0,0,0,0],
[3610,7592,12553,21865,32856,41380,49119,55949,57169,55042,49582,42358,33511,25055,17508,10980,6906,3930,2034,1051,442,154,51,12,5,1,0,0,0,0,0],
[3119,6587,11041,18403,26954,33486,39006,43842,43796,40580,36154,29423,22835,16486,11135,6906,4004,2133,996,451,170,67,20,2,0,0,0,0,0,0,0],
[2837,5573,8879,14792,21252,26005,29384,31957,31017,28427,24555,19626,14573,10038,6684,3930,2133,1108,502,196,79,28,9,0,0,0,0,0,0,0,0],
[2112,4334,6840,11079,15810,18475,20966,22130,20891,18496,15583,11964,8593,5677,3596,2034,996,502,180,66,20,9,0,0,0,0,0,0,0,0,0],
[1658,3257,5154,8307,11069,13074,14286,14839,13594,11543,9358,6976,4785,3138,1842,1051,451,196,66,22,5,0,0,0,0,0,0,0,0,0,0],
[1214,2464,3677,5660,7596,8609,9137,9293,8288,6781,5319,3899,2597,1530,839,442,170,79,20,5,0,0,0,0,0,0,0,0,0,0,0],
[811,1567,2441,3769,4873,5428,5542,5339,4604,3818,2758,1962,1209,673,350,154,67,28,9,0,0,0,0,0,0,0,0,0,0,0,0],
[529,1029,1437,2300,2911,3059,3137,2840,2458,1838,1382,844,509,278,134,51,20,9,0,0,0,0,0,0,0,0,0,0,0,0,0],
[315,646,910,1320,1639,1777,1665,1567,1256,923,606,365,201,74,48,12,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[208,352,541,783,918,888,866,706,564,437,259,144,66,39,13,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[118,202,277,375,415,429,397,310,250,156,78,50,28,10,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[50,110,181,188,223,216,192,147,99,67,25,14,7,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[38,39,71,86,84,82,73,47,31,16,10,6,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[15,22,30,30,34,34,29,17,12,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[5,10,10,14,8,7,7,7,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[2,3,6,7,5,2,3,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]
</script>

                        



<script type="text/javascript">
    // const firebase = require("firebase");
    // Required for side-effects
    // require("firebase/firestore");

    $(document).ready(function () {
        console.log('ready')
        const scrollTop = getScrollTop()
        console.log(scrollTop)
        $("#sidebar").scrollTop(scrollTop)
        $("#sidebar").scroll(function() {
          localStorage.scrollTop = $("#sidebar").scrollTop()
        })
        // $("#sidebar").mCustomScrollbar({
        //     theme: "minimal",
        //     mouseWheel: {preventDefault: true},
        //     advanced:{
        //      autoScrollOnFocus: false,
        //      updateOnContentResize: true
        //     },
        //     scrollInertia:0,
        //     contentTouchScroll:1,
        //     mouseWheel: {
        //         scrollAmount:1000
        //     },
        //     setTop:scrollTop + 'px',
        //     callbacks:{
        //         onScroll:function(){
        //             if(hasStorage) {

        //                 localStorage.scrollTop = this.mcs.top;
        //                 console.log(localStorage.scrollTop)
        //             }
        //         }
        //     } 
        // });

        $('#sidebarCollapse').on('click', function () {
            $('#sidebar, #content').toggleClass('active');
            $('.collapse.in').toggleClass('in');
            $('a[aria-expanded=true]').attr('aria-expanded', 'false');
        });

        
        let lastPart = getUrlKey()
        
        // Bug: this code will highlight anything which matches with the last part
        $("#sidebar").find('a').each(function(){
            // find link which ends with last part and add style
            let currLink = $($(this)[0]).attr('href')
            let currLastPart = getLastPartOfUrl(currLink)
            if (currLastPart === lastPart) {
                $($(this)[0]).addClass('active-link');
            }
        })
    });

    function getScrollTop() {
        if(typeof(Storage) !== "undefined") {
            return Number(localStorage.scrollTop)
        }
        return 0;
    }

    function getUrlKey() {
        var path = window.location.pathname;
        return getLastPartOfUrl(path)
        
    }

    function getLastPartOfUrl(path) {
        let parts = path.split('/')
        var currIndex = parts.length - 1
        while(currIndex >= 0) {
            let nextPart = parts[currIndex]
            if(nextPart) {
                return nextPart
            }
            currIndex -= 1
        }
        return ''
    }

    function submitQuestion() {
        firebase.initializeApp({
          apiKey: "AIzaSyBqZVV7Qrp0DT3aBCCTCTMUCrPJO0pb3tY",
          authDomain: "probability-digital-world.firebaseapp.com",
          projectId: "probability-digital-world"
        });

        var db = firebase.firestore();

        db.collection("questions").add({
            email: $("#question-email").val(),
            question: "Lovelace",
            page: getUrlKey()
        })
        .then(function(docRef) {
            console.log("Document written with ID: ", docRef.id);
            alert('success')
        })
        .catch(function(error) {
            console.error("Error adding document: ", error);
        });
        // // // Generate a new push ID for the new post
        // var questionListRef = db.child("questions")
        // var newQuestionRef = questionListRef.push();
        // newQuestionRef.set({
        //     'title':'test'
        // });
        
    }

    function onCuriosity() {
        Swal.fire({
          title: 'Curious?',
          position: 'bottom-end',
          allowOutsideClick:false,
          backdrop:false,
          confirmButtonText: 'Submit',
          input: 'textarea',
          html:
            '<p>We are trying to make this book better. Let us know if you find something confusing. If you ask a question we will try to answer it. If you find a mistake we will fix it. </p>' +
            '<input placeholder="Your email (optional)..." id="question-email" class="swal2-input">',
          inputPlaceholder: 'Type your question or message here...',
          inputAttributes: {
            'aria-label': 'Type your question or message here'
          },
          showCancelButton: true,
          preConfirm: () => submitQuestion()
        })
    }
</script>

                         <br/><br/>
                
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>

$(document).ready(function() {
  //addH2Numbers()
  enableSearch()
})

function addH2Numbers() {
  $("h2").each(function(i){
    let title = $(this).html()
    title = `${i+1}. ${title}`
    $(this).html(title)
  })
}

function enableSearch() {
  $("#probability-for-digital-world-search").on('keyup', function (e) {
      if (e.key === 'Enter' || e.keyCode === 13) {
          let query = $("#probability-for-digital-world-search").val()
          
          window.location = `../../search.html?q=${query}`
      }
  });
  // $.ajax({
  //     type: "GET",
  //     url: "../../../searchIndex.json",
  //     dataType: "text",
  //     success: function(data) {addSearchIndexData(data);}
  //  });
}

function standardPMFConfig(xValues, yValues, xLabel, yLabel){
  return {
    type: 'bar',
    data: {
      labels: xValues,
      datasets: [{
        label: 'P(x)',
        fill: false,
        backgroundColor: 'blue',
        borderColor: 'blue',
        data: yValues,
        pointRadius:1,
        maxBarThickness:100,
        pointHitRadius: 20
      }]
    },
    options: {

      steppedLine: false,
      responsive: true,
      tooltips: {
        mode: 'index',
        intersect: false,
      },
      hover: {
        mode: 'nearest',
        intersect: true
      },
      animation: {
            duration: 0
        },
      plugins: {
        legend: {
              display: false
           },
         },
      scales: {
        x: {
          display: true,
          type: 'linear',
          title: {
            display: true,
            text: xLabel
          }
        },
        y: {
          display: true,
          title: {
            display: true,
            text: yLabel
          },
          ticks: {
            beginAtZero: true
          }
        }
      }
    }
  };
}

function standardPDFConfig(xValues, yValues, xLabel, yLabel){
  return {
    type: 'line',
    data: {
      labels: xValues,
      datasets: [{
        label: 'f(x)',
        fill: false,
        backgroundColor: 'blue',
        borderColor: 'blue',
        data: yValues,
        pointRadius:1,
        maxBarThickness:100,
        pointHitRadius: 20
      }]
    },
    options: {
      steppedLine: false,
      responsive: true,
      tooltips: {
        mode: 'index',
        intersect: false,
      },
      hover: {
        mode: 'nearest',
        intersect: true
      },
      animation: {
            duration: 0
        },
      plugins: {
        legend: {
              display: false
           },
         },
      scales: {
        x: {
          display: true,
          type: 'linear',
          title: {
            display: true,
            text: xLabel
          }
        },
        y: {
          display: true,
          title: {
            display: true,
            text: yLabel
          },
          ticks: {
            beginAtZero: true
          }
        }
      }
    }
  };
}

function standardPDFsConfig(datasets, xValues, xLabel, yLabel){
  return {
    type: 'line',
    data: {
      datasets: datasets
    },
    options: {

      steppedLine: false,
      responsive: true,
      tooltips: {
        mode: 'index',
        intersect: false,
      },
      hover: {
        mode: 'nearest',
        intersect: true
      },
      animation: {
            duration: 0
        },
      plugins: {
        legend: {
              display: false
           },
         },
      scales: {
        x: {
          display: true,
          type: 'linear',
          title: {
            display: true,
            text: xLabel
          }
        },
        y: {
          display: true,
          title: {
            display: true,
            text: yLabel
          },
          ticks: {
            beginAtZero: true
          }
        }
      }
    }
  };
}


function addSearchIndexData(data) {
  var idx = lunr(function () {
    this.ref('name')
    this.field('text')

    let documents = JSON.parse(data)

    documents.forEach(function (doc) {
      this.add(doc)
    }, this)

    $("#probability-for-digital-world-search").on('keyup', function (e) {
        if (e.key === 'Enter' || e.keyCode === 13) {
            let query = $("#probability-for-digital-world-search").val()
            let results = idx.search(query)
        }
    });
  })
}

    </script>

</body>




</html>